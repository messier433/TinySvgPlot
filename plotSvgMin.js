function gE(e){return document.getElementById(e)}function gM(e){let t=e.length,l=-1/0;for(;t--;)l=e[t]>l&&isFinite(e[t])?e[t]:l;return l}function gMi(e){let t=e.length,l=1/0;for(;t--;)l=e[t]<l&&isFinite(e[t])?e[t]:l;return l}function n2e(t){var l=["y","z","a","f","p","n","u","m","","k","M","G","T","P","E","Z","Y"],a=Array(t.length);for(idx=0;idx<t.length;++idx){var i=t[idx].toExponential(5).split(/e/);let e=Math.floor(+i[1]/3)+8;e>l.length-1?e=l.length-1:e<0&&(e=0),a[idx]=Math.round(i[0]*Math.pow(10,+i[1]-3*(e-8))*1e3)/1e3+l[e]}return a}function lis(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0;idx<numel;++idx)out[idx]=e+t*idx;return out}function los(e,t,l){return lis(e,t,l).map(Math.log10)}function dec(e,t,l){return lis(e,t,l).map(e=>10**e)}function aSE(e,t,l){var a,i="string"==typeof t?document.createElementNS("http://www.w3.org/2000/svg",t):t;for(a in l)i.setAttribute(a,l[a]);return null!=e&&e.appendChild(i),i}function aST(e,t,l,a,i,n="middle",o="Sans,Arial",r="black"){e=aSE(e,"text",{x:l,y:a,fill:r,"font-size":i,"text-anchor":n,"font-family":o,"stroke-width":1});return e.append(document.createTextNode(t)),e}function aSL(e,t,l,a,i,n="black",o=""){return aSE(e,"line",{x1:t,y1:l,x2:a,y2:i,stroke:n,"stroke-width":1,"stroke-dasharray":o,"vector-effect":"non-scaling-stroke"})}function addSvgRec(e,t,l,a,i,n="none",o="none",r=2,s=0){return aSE(e,"rect",{x:t,y:l,width:a,height:i,rx:s,stroke:o,"stroke-width":r,fill:n,"vector-effect":"non-scaling-stroke"})}function legClk(e,t,l,a,i){var n=gE("svg_leg_"+a),e=e.offsetY-n.y.baseVal.value,o=Math.floor((e-l/2)/(t+l)),n=gE("pl_"+a+"_"+o);if(null!=n){var r=n.style.display;if(0==i){e=gE("gpl_"+a+"_"+o);"none"===r?(gE("pl_"+a+"_"+o).style.display="block",gE("lgi_"+a+"_"+o).style.opacity=1,null!=e&&(e.style.display="block")):(gE("pl_"+a+"_"+o).style.display="none",gE("lgi_"+a+"_"+o).style.opacity=.3,null!=e&&(e.style.display="none"))}else for(idx=0;idx<i;++idx){var s=gE("gpl_"+a+"_"+idx);"none"===r?(gE("pl_"+a+"_"+idx).style.display="block",gE("lgi_"+a+"_"+idx).style.opacity=1,null!=s&&(s.style.display="block")):idx!=o&&(gE("pl_"+a+"_"+idx).style.display="none",gE("lgi_"+a+"_"+idx).style.opacity=.3,null!=s)&&(s.style.display="none")}}}function rS(e,t,l,a,i){var n=gE("svg_leg_"+e),o=gE("svg_draw_"+e),r=gE("svg_top_"+e),s=gE("svg_bottom_"+e),d=gE("svg_left_"+e),e=gE("svg_"+e),g=e.width.baseVal.value-t,h=e.height.baseVal.value-l,c=o.width.baseVal.value,x=o.height.baseVal.value;if(tooltips=document.getElementsByClassName("tooltip"),c!=g)for(o.width.baseVal.value=g,r.width.baseVal.value=g,s.width.baseVal.value=g,n.x.baseVal.value+=g-c,idx=0;idx<tooltips.length;++idx){var p=o.x.baseVal.value,u=tooltips[idx].transform.baseVal[0].matrix.e;tooltips[idx].transform.baseVal[0].matrix.e=p+(u-p)*g/c}if(x!=h)for(o.height.baseVal.value=h,d.height.baseVal.value=h,null!=n&&(n.height.baseVal.value=t=a<(t=h-i)?a:t,n.viewBox.baseVal.height=t),idx=0;idx<tooltips.length;++idx){var v=o.y.baseVal.value,f=tooltips[idx].transform.baseVal[0].matrix.f;tooltips[idx].transform.baseVal[0].matrix.f=v+(f-v)*h/x}}function sL(e,t,l){var a=gE("svg_leg_"+t),t=gE("rect_leg_"+t),e=(a.viewBox.baseVal.y+=e.deltaY,l-a.height.baseVal.value);return a.viewBox.baseVal.y<0&&(a.viewBox.baseVal.y=0),a.viewBox.baseVal.y>e&&(a.viewBox.baseVal.y=e),t.y.baseVal.value=a.viewBox.baseVal.y,!1}function pC(e,t,l,a,i,n,o,r,s,d){if(svgDraw=gE("svg_draw_"+t),svg=gE("svg_"+t),null!=(closestEl=gNL(e.clientX,e.clientY))){for(var g=e.offsetX-svgDraw.x.baseVal.value,e=e.offsetY-svgDraw.y.baseVal.value,h=l/svgDraw.width.baseVal.value,c=a/svgDraw.height.baseVal.value,x=(g*=h,e*=c,closestEl.points),p=g>x[x.length-1].x?x.length-1:0,u=1;u<x.length;++u){x[u].x,x[u].y;if(x[u].x>=g&&x[u-1].x<=g){p=u-1;break}}var u,v=x.length<=(v=p+1)?x.length-1:v,f=(x[u=g-x[p].x>x[v].x-g?v:p].x-g)*(x[u].x-g)+(x[u].y-e)*(x[u].y-e),f=x[p=f<36?u:p].x-x[v=f<36?u:v].x,b=x[p].y-x[v].y,y=f*f+b*b,f=f/y*(x[p].x-g)+b/y*(x[p].y-e),b=x[v].x*(f=v==p?1:f)+x[p].x*(1-f),y=x[v].y*f+x[p].y*(1-f),e=b/h+svgDraw.x.baseVal.value,v=y/c+svgDraw.y.baseVal.value,f=closestEl.id,h=f.slice(("pl_"+t).length,f.length),c=gE("lti_"+t+h),f=gE("pl_"+t+h),f=(lineColor=f.getAttribute("stroke"),sourceCoord=cC([b,y],l,a,[i,n],[o,r],s,d),gE("gpl_"+t+h)),b=(null==f&&(f=aSE(svg,"g",{id:"gpl_"+t+h})),aSE(f,"g",{class:"tooltip",transform:"translate("+e+" "+v+")"})),y=(b.onclick=e=>{"g"==e.srcElement.parentNode.tagName&&e.srcElement.parentNode.remove()},addSvgRec(b,5,-9,0,32,lineColor,"rgb(223,223,223)",1,rx=4)),l=null,a=(null!=c&&(aSE(null,text=aST(b,c.textContent,7,-11,12,"start","Sans,Arial","white"),{"font-weight":"bold"}),l=aSL(b,5,-8,5,-8,stroke="white"),aSE(null,y,{y:-23,height:46})),aST(b,"x: "+n2e([sourceCoord[0]]),7,4,12,"start","Sans,Arial","white"),aST(b,"y: "+n2e([sourceCoord[1]]),7,18,12,"start","Sans,Arial","white"),b.getBBox());aSE(null,y,{width:a.width+4}),null!=l&&l.setAttribute("x2",a.width+4+5),addSvgRec(b,-2,-2,4,4,"black")}}function pM(e,t){2==e.button&&(aSE(null,addSvgRec(svg=gE("svg_"+t),e.offsetX,e.offsetY,0,0,"black"),{id:"zoom_rect"+t,"fill-opacity":"0.3"}),svg.onmousemove=e=>pZ(e,t))}function pZ(e,t){(rectZoom=gE("zoom_rect"+t)).width.baseVal.value=e.offsetX-rectZoom.x.baseVal.value,rectZoom.height.baseVal.value=e.offsetY-rectZoom.y.baseVal.value,2!=e.buttons&&(rectZoom.remove(),(svg=gE("svg_"+t)).onmousemove=null)}function cC(e,t,l,a,i,n,o){return x=e[0]/t*(a[1]-a[0])+a[0],y=(1-e[1]/l)*(i[1]-i[0])+i[0],x=n?Math.pow(10,x):x,y=o?Math.pow(10,y):y,[x,y]}function gNL(l,a){var i=null,n=1/0;for(let t=l-4;t<=l+4;t++)for(let e=a-4;e<=a+4;e++){var o,r=document.elementFromPoint(t,e);"polyline"==r?.tagName&&(o=(t-l)*(t-l)+(e-a)*(e-a))<n&&(n=o,i=r)}return i}function plotSvg(t,e,l,a,{title:i="",subtitle:n="",xlabel:o="",ylabel:r="",xlim:s=[],ylim:d=[],legend:g=[],xScale:X="linear",yScale:h="linear",grid:B=!0,gridMinor:c=[],legendLocation:x="northeastoutside"}={}){var p=10,u=10,v=[1,2,5,10],D=["rgb(0,114,190)","rgb(218,83,25)","rgb(238,178,32)","rgb(126,47,142)","rgb(119,173,48)","rgb(77,191,239)","rgb(163,20,47)"],f=(logXEnbl=!1,"log"==X&&(e=e.map(Math.log10),1<s.length&&(s=s.map(Math.log10),isNaN(s[0])||isNaN(s[1])?s=[]:(s[0]=s[0]==-1/0?0:s[0],s[1]=s[1]==-1/0?0:s[1])),logXEnbl=!0),logYEnbl=!1,"log"==h&&(l=l.map(Math.log10),1<d.length&&(d=d.map(Math.log10),isNaN(d[0])||isNaN(d[1])?d=[]:(d[0]=d[0]==-1/0?0:d[0],d[1]=d[1]==-1/0?0:d[1])),logYEnbl=!0),gE(t)),b=document.createElement("div"),f=(f.appendChild(b),b.setAttribute("style","width:100%;height:calc(100vh - 16px);overflow:none"),aSE(b,"svg",{id:"svg_"+t,width:"100%",height:"100%"})),b=(b=f.width.baseVal.value)<1200?1200:b,y=(y=f.height.baseVal.value)<800?800:y,w=(f.innerHTML+="<style>\n<![CDATA[\n  polyline.l {\n    stroke-width:2;\n    vector-effect:non-scaling-stroke;\n    fill:none;\n  }\n  text.cll {\n    font-size:10px;\n    fill:black;\n    dominant-baseline:central;\n    font-family:Lucida Sans Typewriter;\n  }\n]]>\n</style>\n",0),E=48,R=i.split("\n"),Z=n.split("\n"),m=(0<i.length&&(w+=28*R.length),0<n.length&&(w+=16*Z.length),y-(w+=10)-24),k=b-E,S=(0<o.length&&(m=m-12-4),0<r.length&&(E=E+12+4,k=k-12-4),aSE(null,"g",{"pointer-events":"visible"})),z=(S.onclick=e=>legClk(e,hLetter,4,t,0),S.ondblclick=e=>legClk(e,hLetter,4,t,a),0);if(0<g.length&&0<a&&0<e.length){var O="";switch(x){case"northeast":yLegend=w+8,z=16,O="white";break;case"northeastoutside":yLegend=w,O="none";break;default:throw new Error("LegendLocation not supported")}hLegendMax=m-z,f.appendChild(S);var _=aSE(f,"defs"),A=(aSE(_,"line",{id:"ll_"+t,x1:0,y1:0,x2:20,y2:0,"stroke-width":2,"vector-effect":"non-scaling-stroke"}),wLegendMax=400,hLetter=10,aSE(S,"svg",{id:"svg_leg_"+t})),F=a,U=g,G=(g.length>a&&(U=g.slice(0,F)),F*(hLetter+4)+4),_=G>hLegendMax?hLegendMax:G,M=(aSE(null,A,{x:"100%",height:_}),addSvgRec(A,0,0,0,"100%",O,"black"));for(aSE(null,M,{id:"rect_leg_"+t}),lnIdx=0;lnIdx<F;++lnIdx){colorIdx=lnIdx%D.length,yOffset=lnIdx*(hLetter+4)+4;var H=new aSE(A,"g",{id:"lgi_"+t+"_"+lnIdx}),j=(aSE(H,"use",{id:"lli_"+t+"_"+lnIdx,x:4,y:yOffset+hLetter/2,href:"#ll_"+t,stroke:D[colorIdx]}),aSE(H,"text",{id:"lti_"+t+"_"+lnIdx,class:"cll",x:28,y:yOffset+hLetter/2})),H="";lnIdx<U.length&&(H=U[lnIdx]),j.append(document.createTextNode(H))}var T=(T=S.getBBox().width+8)>wLegendMax?wLegendMax:T,q=(M.setAttribute("width","100%"),A.setAttribute("width",T),0);switch(x){case"northeast":q=-T-8-48,k-=48;break;case"northeastoutside":q=-T,k-=T+4;break;default:throw new Error("LegendLocation not supported")}aSE(null,A,{x:f.width.baseVal.value+q,y:yLegend,viewBox:"0 0 "+T+" "+_})}else k-=48;var V=[b-(pltAr=[E,w,k,m])[2],y-pltAr[3]],J=aSE(f,"svg",{id:"svg_top_"+t,x:pltAr[0],overflow:"visible",width:f.width.baseVal.value-V[0]}),L=0;if(0<i.length)for(idx=0;idx<R.length;++idx)L=L+24+4,aST(J,R[idx],"50%",L,24);if(0<n.length)for(idx=0;idx<Z.length;++idx)L=L+12+4,aST(J,Z[idx],"50%",L,12);var M=-y+pltAr[1]+pltAr[3],x=aSE(f,"g",{transform:"translate("+pltAr[0]+" "+M+")"}),K=aSE(x,"svg",{id:"svg_bottom_"+t,overflow:"visible",y:"100%",width:f.width.baseVal.value-V[0]}),Q=(0<o.length&&aST(K,o,"50%",36,12),aSE(f,"svg",{id:"svg_left_"+t,y:pltAr[1],overflow:"visible",height:f.height.baseVal.value-V[1]})),I=(0<r.length&&aSE(Q,"text",{"writing-mode":"sideways-lr",fill:"black","font-size":12,"text-anchor":"middle","font-family":"Sans,Arial","stroke-width":1,y:"50%",x:pltAr[0]-48-4}).append(document.createTextNode(r)),0),C=0,N=0,Y=0,_=(s.length<2?(I=gMi(e),C=gM(e),I==C&&(I-=.5,C+=.5)):(I=s[0],C=s[1]),d.length<2?(N=gMi(l),Y=gM(l),N==Y&&(N-=.5,Y+=.5)):(N=d[0],Y=d[1]),f.width.baseVal.value-V[0]),b=f.height.baseVal.value-V[1],P=aSE(f,"svg",{id:"svg_draw_"+t,preserveAspectRatio:"none",viewBox:"0 0 "+pltAr[2]+" "+pltAr[3],width:_,height:b,x:pltAr[0],y:pltAr[1]}),E=!1,m=!1,m=c.length<1?(E="log"==X,"log"==h):(E=c[0],c[1]),i=(C-I)/10,n=Math.floor(Math.log10(i)),W=Math.ceil(i/Math.pow(10,n)),y=v.findIndex(function(e){return W<=e}),i=v[y]*Math.pow(10,n),M=(logXEnbl?1<=C-I?1<(i=i<1?1:i)&&(p=p<i?p:i):p=0:p=5,(Y-N)/10),n=Math.floor(Math.log10(M)),W=Math.ceil(M/Math.pow(10,n)),y=v.findIndex(function(e){return W<=e}),M=v[y]*Math.pow(10,n),x=(logYEnbl?1<=Y-N?1<(M=M<1?1:M)&&(u=u<M?u:M):u=0:u=5,s.length<1&&4<=(C-I)/i&&(I=Math.floor(I/i)*i,C=Math.ceil(C/i)*i),d.length<1&&4<=(Y-N)/M&&(N=Math.floor(N/M)*M,Y=Math.ceil(Y/M)*M),Math.ceil(I/i)*i),o=Math.floor(C/i)*i,r=Math.ceil(N/M)*M,_=Math.floor(Y/M)*M,b=pltAr[2]*(x-I)/(C-I),X=pltAr[3]*(_-Y)/(Y-N),$=100*(x-I)/(C-I),ee=100*(_-Y)/(Y-N),te=Math.round((o-x)/i),le=Math.round((_-r)/M),h=pltAr[2]>pltAr[3]?pltAr[2]/100:pltAr[3]/100,c=h/2;for(xTickLabel=logXEnbl?n2e(dec(x,i,o)):n2e(lis(x,i,o)),yTickLabel=logYEnbl?n2e(dec(r,M,_)):n2e(lis(r,M,_)),dXTick=pltAr[2]*i/(C-I),dXTickPct=100*i/(C-I),dYTick=pltAr[3]*M/(Y-N),dYTickPct=100*M/(Y-N),idx=0;idx<=le;++idx){var ae=-ee+dYTickPct*idx;(j=aST(Q,yTickLabel[le-idx],pltAr[0]-6,ae+"%",12,"end")).setAttribute("dominant-baseline","central")}for(idx=0;idx<=te;++idx){var ie=dXTickPct*idx+$;aST(K,xTickLabel[idx],ie+"%",12*1.4,12)}var v=aSE(P,"defs"),ne=(m&&0<u&&(y=aSE(v,"g",{id:"mgy_"+t}),B&&aSL(y,0,1,pltAr[2],1,stroke="rgb(223,223,223)",strokedasharray="2 4"),aSL(y,0,1,c,1),aSL(y,pltAr[2]-c,1,pltAr[2],1),v.appendChild(y)),aSE(v,"pattern",{id:"yTick_"+t,x:0,y:X-1,width:pltAr[2],height:dYTick,patternUnits:"userSpaceOnUse"}));if(m&&0<u)for(logYEnbl&&1==M?(minorTickPos=los(1,9/(u-1),10)).forEach((e,t)=>{minorTickPos[t]=(1-minorTickPos[t])*dYTick}):minorTickPos=lis(0,1/u*dYTick,dYTick),idx=1;idx<minorTickPos.length-1;++idx)aSE(ne,"use",{href:"#mgy_"+t,y:minorTickPos[idx]});B&&aSL(ne,0,1,pltAr[2],1,stroke="rgb(223,223,223)"),aSL(ne,0,1,h,1),aSL(ne,pltAr[2]-h,1,pltAr[2],1),addSvgRec(P,0,0,pltAr[2],pltAr[3],"url(#yTick_"+t+")");var n=aSE(P,"defs"),oe=(E&&0<p&&(s=aSE(n,"g",{id:"mgx_"+t}),B&&aSL(s,1,0,1,pltAr[3],stroke="rgb(223,223,223)",strokedasharray="2 4"),aSL(s,1,0,1,c),aSL(s,1,pltAr[3]-c,1,pltAr[3])),aSE(n,"pattern",{id:"xTick_"+t,x:b-1,y:0,width:dXTick,height:pltAr[3],patternUnits:"userSpaceOnUse"}));if(E&&0<p)for(logXEnbl&&1==i?(minorTickPos=los(1,9/(p-1),10)).forEach((e,t)=>{minorTickPos[t]*=dXTick}):minorTickPos=lis(0,1/p*dXTick,dXTick),idx=1;idx<minorTickPos.length-1;++idx)aSE(oe,"use",{href:"#mgx_"+t,x:minorTickPos[idx],"vector-effect":"non-scaling-stroke"});B&&aSL(oe,1,0,1,pltAr[3],stroke="rgb(223,223,223)"),aSL(oe,1,0,1,h),aSL(oe,1,pltAr[3]-h,1,pltAr[3]),addSvgRec(P,0,0,pltAr[2],pltAr[3],"url(#xTick_"+t+")");var re=l.length/a,se=e.length==l.length;if(!se&&re!=e.length)throw new Error("Dimension must agree");for(lnIdx=0;lnIdx<a;++lnIdx){var de=e.length,ge=(new Array(2*de),colorIdx=lnIdx%D.length,document.createElementNS("http://www.w3.org/2000/svg","polyline"));for(ge.setAttribute("class","l"),ge.setAttribute("id","pl_"+t+"_"+lnIdx),ge.setAttribute("stroke",D[colorIdx]),ptIdx=0;ptIdx<re;++ptIdx){var he,ce=se?e[lnIdx*re+ptIdx]:e[ptIdx],xe=l[lnIdx*re+ptIdx];isFinite(ce)&&isFinite(xe)&&((he=P.createSVGPoint()).x=pltAr[2]*(ce-I)/(C-I),he.y=pltAr[3]-pltAr[3]*(xe-N)/(Y-N),ge.points.appendItem(he))}P.appendChild(ge)}addSvgRec(P,0,0,pltAr[2],pltAr[3],"none","black"),f.appendChild(S),P.onclick=e=>pC(e,t,pltAr[2],pltAr[3],I,C,N,Y,logXEnbl,logYEnbl),f.oncontextmenu=e=>{e.preventDefault()},P.onmousedown=e=>pM(e,t),f.onmousedown=e=>{e.preventDefault()},0<g.length&&(S.onwheel=e=>sL(e,t,G)),new ResizeObserver(()=>rS(t,V[0],V[1],G,z)).observe(f)}