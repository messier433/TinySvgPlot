function gE(e){return document.getElementById(e)}function gM(e){let t=e.length,l=-1/0;for(;t--;)l=e[t]>l&&isFinite(e[t])?e[t]:l;return l}function gMi(e){let t=e.length,l=1/0;for(;t--;)l=e[t]<l&&isFinite(e[t])?e[t]:l;return l}function n2e(t){var l=["y","z","a","f","p","n","u","m","","k","M","G","T","P","E","Z","Y"],a=Array(t.length);for(idx=0;idx<t.length;++idx){var n=t[idx].toExponential(5).split(/e/);let e=Math.floor(+n[1]/3)+8;e>l.length-1?e=l.length-1:e<0&&(e=0),a[idx]=Math.round(n[0]*Math.pow(10,+n[1]-3*(e-8))*1e3)/1e3+l[e]}return a}function lis(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0;idx<numel;++idx)out[idx]=e+t*idx;return out}function los(e,t,l){return lis(e,t,l).map(Math.log10)}function dec(e,t,l){return lis(e,t,l).map(e=>10**e)}function aSE(e,t,l){var a,n="string"==typeof t?document.createElementNS("http://www.w3.org/2000/svg",t):t;for(a in l)n.setAttribute(a,l[a]);return null!=e&&e.appendChild(n),n}function aST(e,t,l,a,n,i="middle",o="Sans,Arial",r="black"){e=aSE(e,"text",{x:l,y:a,fill:r,"font-size":n,"text-anchor":i,"font-family":o,"stroke-width":1});return e.append(document.createTextNode(t)),e}function aSL(e,t,l,a,n,i="black",o=""){return aSE(e,"line",{x1:t,y1:l,x2:a,y2:n,stroke:i,"stroke-width":1,"stroke-dasharray":o,"vector-effect":"non-scaling-stroke"})}function addSvgRec(e,t,l,a,n,i="none",o="none",r=2,s=0){return aSE(e,"rect",{x:t,y:l,width:a,height:n,rx:s,stroke:o,"stroke-width":r,fill:i,"vector-effect":"non-scaling-stroke"})}function tL(e,t,l){var a=gE("pl_"+e+"_"+t).style.display;if(0==l){var n=gE("gpl_"+e+"_"+t);"none"===a?(gE("pl_"+e+"_"+t).style.display="block",gE("lli_"+e+"_"+t).style.opacity=1,gE("lti_"+e+"_"+t).style.opacity=1,null!=n&&(n.style.display="block")):(gE("pl_"+e+"_"+t).style.display="none",gE("lli_"+e+"_"+t).style.opacity=.3,gE("lti_"+e+"_"+t).style.opacity=.3,null!=n&&(n.style.display="none"))}else for(idx=0;idx<l;++idx){var i=gE("gpl_"+e+"_"+idx);"none"===a?(gE("pl_"+e+"_"+idx).style.display="block",gE("lli_"+e+"_"+idx).style.opacity=1,gE("lti_"+e+"_"+idx).style.opacity=1,null!=i&&(i.style.display="block")):idx!=t&&(gE("pl_"+e+"_"+idx).style.display="none",gE("lli_"+e+"_"+idx).style.opacity=.3,gE("lti_"+e+"_"+idx).style.opacity=.3,null!=i)&&(i.style.display="none")}}function rS(e,t,l,a,n){var i=gE("svg_leg_"+e),o=gE("svg_draw_"+e),e=gE("svg_"+e),r=e.width.baseVal.value-t,s=e.height.baseVal.value-l,d=o.width.baseVal.value,g=o.height.baseVal.value;if(tooltips=document.getElementsByClassName("tooltip"),d!=r)for(o.width.baseVal.value=r,idx=0;idx<tooltips.length;++idx){var c=o.x.baseVal.value,h=tooltips[idx].transform.baseVal[0].matrix.e;tooltips[idx].transform.baseVal[0].matrix.e=c+(h-c)*r/d}if(g!=s)for(o.height.baseVal.value=s,null!=i&&(i.height.baseVal.value=t=a<(t=s-n)?a:t,i.viewBox.baseVal.height=t),idx=0;idx<tooltips.length;++idx){var x=o.y.baseVal.value,p=tooltips[idx].transform.baseVal[0].matrix.f;tooltips[idx].transform.baseVal[0].matrix.f=x+(p-x)*s/g}}function sL(e,t,l){var a=gE("svg_leg_"+t),t=gE("rect_leg_"+t),e=(a.viewBox.baseVal.y+=e.deltaY,l-a.height.baseVal.value);return a.viewBox.baseVal.y<0&&(a.viewBox.baseVal.y=0),a.viewBox.baseVal.y>e&&(a.viewBox.baseVal.y=e),t.y.baseVal.value=a.viewBox.baseVal.y,!1}function pC(e,t,l,a,n,i,o,r,s,d){if(svgDraw=gE("svg_draw_"+t),svg=gE("svg_"+t),null!=(closestEl=gNL(e.clientX,e.clientY))){for(var g=e.offsetX-svgDraw.x.baseVal.value,e=e.offsetY-svgDraw.y.baseVal.value,c=l/svgDraw.width.baseVal.value,h=a/svgDraw.height.baseVal.value,x=(g*=c,e*=h,closestEl.points),p=g>x[x.length-1].x?x.length-1:0,u=1;u<x.length;++u){x[u].x,x[u].y;if(x[u].x>=g&&x[u-1].x<=g){p=u-1;break}}var u,f=x.length<=(f=p+1)?x.length-1:f,v=(x[u=g-x[p].x>x[f].x-g?f:p].x-g)*(x[u].x-g)+(x[u].y-e)*(x[u].y-e),v=x[p=v<36?u:p].x-x[f=v<36?u:f].x,y=x[p].y-x[f].y,b=v*v+y*y,v=v/b*(x[p].x-g)+y/b*(x[p].y-e),y=x[f].x*(v=f==p?1:v)+x[p].x*(1-v),b=x[f].y*v+x[p].y*(1-v),e=y/c+svgDraw.x.baseVal.value,f=b/h+svgDraw.y.baseVal.value,v=closestEl.id,c=v.slice(("pl_"+t).length,v.length),h=gE("lti_"+t+c),v=gE("pl_"+t+c),v=(lineColor=v.getAttribute("stroke"),sourceCoord=cC([y,b],l,a,[n,i],[o,r],s,d),gE("gpl_"+t+c)),y=(null==v&&(v=aSE(svg,"g",{id:"gpl_"+t+c})),aSE(v,"g",{class:"tooltip",transform:"translate("+e+" "+f+")"})),b=(y.onclick=e=>{"g"==e.srcElement.parentNode.tagName&&e.srcElement.parentNode.remove()},addSvgRec(y,5,-9,0,0,lineColor,"rgb(223,223,223)",1,rx=4)),l=null,a=(null!=h&&(aSE(null,text=aST(y,h.textContent,7,-11,12,"start","Sans,Arial","white"),{"font-weight":"bold"}),l=aSL(y,5,-8,5,-8,stroke="white"),b.setAttribute("y",-23)),aST(y,"x: "+n2e([sourceCoord[0]]),7,4,12,"start","Sans,Arial","white"),aST(y,"y: "+n2e([sourceCoord[1]]),7,18,12,"start","Sans,Arial","white"),y.getBBox());aSE(null,b,{width:a.width+4,height:a.height+4}),null!=l&&l.setAttribute("x2",a.width+4+5),addSvgRec(y,-2,-2,4,4,"black")}}function pM(e,t){2==e.button&&(aSE(null,addSvgRec(svg=gE("svg_"+t),e.offsetX,e.offsetY,0,0,"black"),{id:"zoom_rect"+t,"fill-opacity":"0.3"}),svg.onmousemove=e=>pZ(e,t))}function pZ(e,t){(rectZoom=gE("zoom_rect"+t)).width.baseVal.value=e.offsetX-rectZoom.x.baseVal.value,rectZoom.height.baseVal.value=e.offsetY-rectZoom.y.baseVal.value,2!=e.buttons&&(rectZoom.remove(),(svg=gE("svg_"+t)).onmousemove=null)}function cC(e,t,l,a,n,i,o){return x=e[0]/t*(a[1]-a[0])+a[0],y=(1-e[1]/l)*(n[1]-n[0])+n[0],x=i?Math.pow(10,x):x,y=o?Math.pow(10,y):y,[x,y]}function gNL(l,a){var n=null,i=1/0;for(let t=l-4;t<=l+4;t++)for(let e=a-4;e<=a+4;e++){var o,r=document.elementFromPoint(t,e);"polyline"==r?.tagName&&(o=(t-l)*(t-l)+(e-a)*(e-a))<i&&(i=o,n=r)}return n}function plotSvg(t,e,l,a,{title:n="",subtitle:i="",xlabel:o="",ylabel:r="",xlim:s=[],ylim:d=[],legend:g=[],xScale:X="linear",yScale:B="linear",grid:D=!0,gridMinor:c=[],legendLocation:h="northeastoutside"}={}){var x=10,p=10,u=[1,2,5,10],f=["rgb(0,114,190)","rgb(218,83,25)","rgb(238,178,32)","rgb(126,47,142)","rgb(119,173,48)","rgb(77,191,239)","rgb(163,20,47)"],v=(logXEnbl=!1,"log"==X&&(e=e.map(Math.log10),1<s.length&&(s=s.map(Math.log10),isNaN(s[0])||isNaN(s[1])?s=[]:(s[0]=s[0]==-1/0?0:s[0],s[1]=s[1]==-1/0?0:s[1])),logXEnbl=!0),logYEnbl=!1,"log"==B&&(l=l.map(Math.log10),1<d.length&&(d=d.map(Math.log10),isNaN(d[0])||isNaN(d[1])?d=[]:(d[0]=d[0]==-1/0?0:d[0],d[1]=d[1]==-1/0?0:d[1])),logYEnbl=!0),gE(t)),y=document.createElement("div"),v=(v.appendChild(y),y.setAttribute("style","width:100%;height:calc(100vh - 16px);overflow:none"),aSE(y,"svg",{id:"svg_"+t,width:"100%",height:"100%"})),y=(y=v.width.baseVal.value)<1200?1200:y,b=(b=v.height.baseVal.value)<800?800:b,E=(v.innerHTML+="<style>\n<![CDATA[\n  polyline.l {\n    stroke-width:2;\n    vector-effect:non-scaling-stroke;\n    fill:none;\n  }\n  text.cll {\n    font-size:10px;\n    fill:black;\n    dominant-baseline:middle;\n    font-family:Lucida Sans Typewriter;\n  }\n]]>\n</style>\n",0),w=48,R=n.split("\n"),O=i.split("\n"),m=(0<n.length&&(E+=28*R.length),0<i.length&&(E+=16*O.length),b-(E+=10)-24),S=y-w,_=(0<o.length&&(m=m-12-4),0<r.length&&(w=w+12+4,S=S-12-4),aSE(null,"g")),Z=0;if(0<g.length&&0<a&&0<e.length){var z="";switch(h){case"northeast":yLegend=E+8,Z=16,z="white";break;case"northeastoutside":yLegend=E,z="none";break;default:throw new Error("LegendLocation not supported")}hLegendMax=m-Z,v.appendChild(_);var k=aSE(v,"defs"),A=(aSE(k,"line",{id:"ll_"+t,x1:0,y1:0,x2:20,y2:0,"stroke-width":2,"vector-effect":"non-scaling-stroke"}),wLegendMax=400,hLetter=10,aSE(_,"svg",{id:"svg_leg_"+t})),F=a,U=g,G=(g.length>a&&(U=g.slice(0,F)),F*(hLetter+4)+4),k=G>hLegendMax?hLegendMax:G,H=(aSE(null,A,{x:"100%",height:k}),addSvgRec(A,0,0,0,"100%",z,"black"));for(aSE(null,H,{id:"rect_leg_"+t}),lnIdx=0;lnIdx<F;++lnIdx){colorIdx=lnIdx%f.length,yOffset=lnIdx*(hLetter+4)+4;var j=new aSE(A,"g",{id:"lgi_"+t+"_"+lnIdx,onclick:'tL("'+t+'", '+lnIdx+", 0);",ondblclick:'tL("'+t+'", '+lnIdx+", "+a+");"}),q=(aSE(j,"use",{id:"lli_"+t+"_"+lnIdx,x:4,y:yOffset+hLetter/2,href:"#ll_"+t,stroke:f[colorIdx]}),aSE(j,"text",{id:"lti_"+t+"_"+lnIdx,class:"cll",x:28,y:yOffset+hLetter/2}));lnIdx<U.length?q.append(document.createTextNode(U[lnIdx])):q.append(document.createTextNode(""))}var T=(T=_.getBBox().width+8)>wLegendMax?wLegendMax:T;for(H.setAttribute("width","100%"),A.setAttribute("width",T),lnIdx=0;lnIdx<F;++lnIdx){colorIdx=lnIdx%f.length,yOffset=lnIdx*(hLetter+4)+4;const j=gE("lgi_"+t+"_"+lnIdx);aSE(null,H=addSvgRec(j,4,yOffset,T,hLetter+4),{id:"lri_"+t+"_"+lnIdx,"pointer-events":"visible"})}var J=0;switch(h){case"northeast":J=-T-8-48,S-=48;break;case"northeastoutside":J=-T,S-=T+4;break;default:throw new Error("LegendLocation not supported")}aSE(null,A,{x:"calc(100% + "+J+"px)",y:yLegend,viewBox:"0 0 "+T+" "+k})}else S-=48;var L=[y-(pltAr=[w,E,S,m])[2],b-pltAr[3]],K=aSE(v,"svg",{x:pltAr[0],overflow:"visible",width:"calc(100% - "+L[0]+"px)"}),M=0;if(0<n.length)for(idx=0;idx<R.length;++idx)M=M+24+4,aST(K,R[idx],"50%",M,24);if(0<i.length)for(idx=0;idx<O.length;++idx)M=M+12+4,aST(K,O[idx],"50%",M,12);var h=-b+pltAr[1]+pltAr[3],k=aSE(v,"g",{transform:"translate("+pltAr[0]+" "+h+")"}),Q=aSE(k,"svg",{overflow:"visible",y:"100%",width:"calc(100% - "+L[0]+"px)"}),W=(0<o.length&&aST(Q,o,"50%",36,12),aSE(v,"svg",{y:pltAr[1],overflow:"visible",height:"calc(100% - "+L[1]+"px)"})),I=(0<r.length&&aSE(W,"text",{"writing-mode":"sideways-lr",fill:"black","font-size":12,"text-anchor":"middle","font-family":"Sans,Arial","stroke-width":1,y:"50%",x:pltAr[0]-48-4}).append(document.createTextNode(r)),0),V=0,N=0,Y=0,y=(s.length<2?(I=gMi(e),V=gM(e),NaN==I&&(I=0,V=1),I==V&&(I-=.5,V+=.5)):(I=s[0],V=s[1]),d.length<2?(N=gMi(l),Y=gM(l),NaN==N&&(N=0,Y=1),N==Y&&(N-=.5,Y+=.5)):(N=d[0],Y=d[1]),v.width.baseVal.value-L[0]),w=v.height.baseVal.value-L[1],C=aSE(v,"svg",{id:"svg_draw_"+t,preserveAspectRatio:"none",viewBox:"0 0 "+pltAr[2]+" "+pltAr[3],width:y,height:w,x:pltAr[0],y:pltAr[1]}),m=!1,n=!1,n=c.length<1?(m="log"==X,"log"==B):(m=c[0],c[1]),i=(V-I)/10,b=Math.floor(Math.log10(i)),$=Math.ceil(i/Math.pow(10,b)),h=u.findIndex(function(e){return $<=e}),i=u[h]*Math.pow(10,b),k=(logXEnbl?1<=V-I?1<(i=i<1?1:i)&&(x=x<i?x:i):x=0:x=5,(Y-N)/10),b=Math.floor(Math.log10(k)),$=Math.ceil(k/Math.pow(10,b)),h=u.findIndex(function(e){return $<=e}),k=u[h]*Math.pow(10,b),o=(logYEnbl?1<=Y-N?1<(k=k<1?1:k)&&(p=p<k?p:k):p=0:p=5,s.length<1&&4<=(V-I)/i&&(I=Math.floor(I/i)*i,V=Math.ceil(V/i)*i),d.length<1&&4<=(Y-N)/k&&(N=Math.floor(N/k)*k,Y=Math.ceil(Y/k)*k),Math.ceil(I/i)*i),r=Math.floor(V/i)*i,y=Math.ceil(N/k)*k,w=Math.floor(Y/k)*k,X=pltAr[2]*(o-I)/(V-I),B=pltAr[3]*(w-Y)/(Y-N),ee=100*(o-I)/(V-I),te=100*(w-Y)/(Y-N),le=Math.round((r-o)/i),ae=Math.round((w-y)/k),c=pltAr[2]>pltAr[3]?pltAr[2]/100:pltAr[3]/100,u=c/2;for(xTickLabel=logXEnbl?n2e(dec(o,i,r)):n2e(lis(o,i,r)),yTickLabel=logYEnbl?n2e(dec(y,k,w)):n2e(lis(y,k,w)),dXTick=pltAr[2]*i/(V-I),dXTickPct=100*i/(V-I),dYTick=pltAr[3]*k/(Y-N),dYTickPct=100*k/(Y-N),idx=0;idx<=ae;++idx){var ne=-te+dYTickPct*idx;(q=aST(W,yTickLabel[ae-idx],pltAr[0]-6,ne+"%",12,"end")).setAttribute("alignment-baseline","middle")}for(idx=0;idx<=le;++idx){var ie=dXTickPct*idx+ee;aST(Q,xTickLabel[idx],ie+"%",12*1.4,12)}var h=aSE(C,"defs"),oe=(n&&0<p&&(b=aSE(h,"g",{id:"mgy_"+t}),D&&aSL(b,0,1,pltAr[2],1,stroke="rgb(223,223,223)",strokedasharray="2 4"),aSL(b,0,1,u,1),aSL(b,pltAr[2]-u,1,pltAr[2],1),h.appendChild(b)),aSE(h,"pattern",{id:"yTick_"+t,x:0,y:B-1,width:pltAr[2],height:dYTick,patternUnits:"userSpaceOnUse"}));if(n&&0<p)for(logYEnbl&&1==k?(minorTickPos=los(1,9/(p-1),10)).forEach((e,t)=>{minorTickPos[t]=(1-minorTickPos[t])*dYTick}):minorTickPos=lis(0,1/p*dYTick,dYTick),idx=1;idx<minorTickPos.length-1;++idx)aSE(oe,"use",{href:"#mgy_"+t,y:minorTickPos[idx]});D&&aSL(oe,0,1,pltAr[2],1,stroke="rgb(223,223,223)"),aSL(oe,0,1,c,1),aSL(oe,pltAr[2]-c,1,pltAr[2],1),addSvgRec(C,0,0,pltAr[2],pltAr[3],"url(#yTick_"+t+")");var s=aSE(C,"defs"),re=(m&&0<x&&(d=aSE(s,"g",{id:"mgx_"+t}),D&&aSL(d,1,0,1,pltAr[3],stroke="rgb(223,223,223)",strokedasharray="2 4"),aSL(d,1,0,1,u),aSL(d,1,pltAr[3]-u,1,pltAr[3])),aSE(s,"pattern",{id:"xTick_"+t,x:X-1,y:0,width:dXTick,height:pltAr[3],patternUnits:"userSpaceOnUse"}));if(m&&0<x)for(logXEnbl&&1==i?(minorTickPos=los(1,9/(x-1),10)).forEach((e,t)=>{minorTickPos[t]*=dXTick}):minorTickPos=lis(0,1/x*dXTick,dXTick),idx=1;idx<minorTickPos.length-1;++idx)aSE(re,"use",{href:"#mgx_"+t,x:minorTickPos[idx],"vector-effect":"non-scaling-stroke"});D&&aSL(re,1,0,1,pltAr[3],stroke="rgb(223,223,223)"),aSL(re,1,0,1,c),aSL(re,1,pltAr[3]-c,1,pltAr[3]),addSvgRec(C,0,0,pltAr[2],pltAr[3],"url(#xTick_"+t+")");var se=l.length/a,de=e.length==l.length;if(!de&&se!=e.length)throw new Error("Dimension must agree");for(lnIdx=0;lnIdx<a;++lnIdx){var ge=e.length,P=(new Array(2*ge),colorIdx=lnIdx%f.length,document.createElementNS("http://www.w3.org/2000/svg","polyline"));for(P.setAttribute("class","l"),P.setAttribute("id","pl_"+t+"_"+lnIdx),P.setAttribute("stroke",f[colorIdx]),ptIdx=0;ptIdx<se;++ptIdx){var ce,he=de?e[lnIdx*se+ptIdx]:e[ptIdx],xe=l[lnIdx*se+ptIdx];isFinite(he)&&isFinite(xe)&&((ce=C.createSVGPoint()).x=pltAr[2]*(he-I)/(V-I),ce.y=pltAr[3]-pltAr[3]*(xe-N)/(Y-N),P.points.appendItem(ce))}C.appendChild(P)}addSvgRec(C,0,0,pltAr[2],pltAr[3],"none","black"),v.appendChild(_),C.onclick=e=>pC(e,t,pltAr[2],pltAr[3],I,V,N,Y,logXEnbl,logYEnbl),v.oncontextmenu=e=>{e.preventDefault()},C.onmousedown=e=>pM(e,t),v.onmousedown=e=>{e.preventDefault()},0<g.length&&(_.onwheel=e=>sL(e,t,G)),new ResizeObserver(()=>rS(t,L[0],L[1],G,Z)).observe(v)}