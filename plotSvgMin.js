function getEl(e){return document.getElementById(e)}function getMax(e){let t=e.length,l=-1/0;for(;t--;)l=e[t]>l?e[t]:l;return l}function getMin(e){let t=e.length,l=1/0;for(;t--;)l=e[t]<l?e[t]:l;return l}function num2eng(t){var l=["y","z","a","f","p","n","u","m","","k","M","G","T","P","E","Z","Y"],i=Array(t.length);for(idx=0;idx<t.length;++idx){var a=t[idx].toExponential(5).split(/e/);let e=Math.floor(+a[1]/3)+8;e>l.length-1?e=l.length-1:e<0&&(e=0),i[idx]=Math.round(a[0]*Math.pow(10,+a[1]-3*(e-8))*1e3)/1e3+l[e]}return i}function linspace(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=val;return out}function logspace(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=Math.log10(val);return out}function decades(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=Math.pow(10,val);return out}function addSvgEl(e,t,l){var i,a="string"==typeof t?document.createElementNS("http://www.w3.org/2000/svg",t):t;for(i in l)a.setAttribute(i,l[i]);return null!=e&&e.appendChild(a),a}function addSvgTxt(e,t,l,i,a,n="middle",o="Sans,Arial",d="black"){e=addSvgEl(e,"text",{x:l,y:i,fill:d,"font-size":a,"text-anchor":n,"font-family":o,"stroke-width":1});return e.append(document.createTextNode(t)),e}function addSvgLn(e,t,l,i,a,n="black",o=""){return addSvgEl(e,"line",{x1:t,y1:l,x2:i,y2:a,stroke:n,"stroke-width":1,"stroke-dasharray":o,"vector-effect":"non-scaling-stroke"})}function toggleLineVisibility(e,t,l){var i=getEl("pl_"+e+"_"+t).style.display;if(0==l){var a=getEl("gpl_"+e+"_"+t);"none"===i?(getEl("pl_"+e+"_"+t).style.display="block",getEl("lli_"+e+"_"+t).style.opacity=1,getEl("lti_"+e+"_"+t).style.opacity=1,null!=a&&(a.style.display="block")):(getEl("pl_"+e+"_"+t).style.display="none",getEl("lli_"+e+"_"+t).style.opacity=.3,getEl("lti_"+e+"_"+t).style.opacity=.3,null!=a&&(a.style.display="none"))}else for(idx=0;idx<l;++idx){var n=getEl("gpl_"+e+"_"+idx);"none"===i?(getEl("pl_"+e+"_"+idx).style.display="block",getEl("lli_"+e+"_"+idx).style.opacity=1,getEl("lti_"+e+"_"+idx).style.opacity=1,null!=n&&(n.style.display="block")):idx!=t&&(getEl("pl_"+e+"_"+idx).style.display="none",getEl("lli_"+e+"_"+idx).style.opacity=.3,getEl("lti_"+e+"_"+idx).style.opacity=.3,null!=n)&&(n.style.display="none")}}function removeInvalidPoints(e){var t=e[0],l=e[1],i=Array(t.length),a=Array(l.length);if(t.length==l.length){var n=0;for(idx=0;idx<l.length;++idx)isFinite(t[idx])&&isFinite(l[idx])&&(i[n]=t[idx],a[n]=l[idx],++n);n<t.length&&(i=i.slice(0,n),a=a.slice(0,n))}else{var n=0,o=l.length/t.length,d=t.length;for(idx=0;idx<d;++idx){var r=isFinite(t[idx]),g=!0;for(idxLines=0;idxLines<o;++idxLines){if(!isFinite(l[idxLines*d+idx])){g=!1;break}a[idxLines*d+n]=l[idxLines*d+idx]}r&&g&&(i[n]=t[idx],++n)}if(n<t.length){for(i=i.slice(0,n),idx=n=0;idx<l.length;++idx)idx%d<i.length&&(a[n]=a[idx],++n);a=a.slice(0,i.length*o)}}return[i,a]}function resizeSvg(e,t,l,i,a){var n=getEl("svg_leg_"+e),o=getEl("svg_draw_"+e),e=getEl("svg_"+e),d=e.width.baseVal.value-t,r=e.height.baseVal.value-l,g=o.width.baseVal.value,s=o.height.baseVal.value;if(tooltips=document.getElementsByClassName("tooltip"),g!=d)for(o.width.baseVal.value=d,idx=0;idx<tooltips.length;++idx){var x=o.x.baseVal.value,h=tooltips[idx].transform.baseVal[0].matrix.e;tooltips[idx].transform.baseVal[0].matrix.e=x+(h-x)*d/g}if(s!=r)for(o.height.baseVal.value=r,null!=n&&(n.height.baseVal.value=t=i<(t=r-a)?i:t,n.viewBox.baseVal.height=t),idx=0;idx<tooltips.length;++idx){var c=o.y.baseVal.value,v=tooltips[idx].transform.baseVal[0].matrix.f;tooltips[idx].transform.baseVal[0].matrix.f=c+(v-c)*r/s}}function scrollLegend(e,t,l){var i=getEl("svg_leg_"+t),t=getEl("rect_leg_"+t),e=(i.viewBox.baseVal.y+=e.deltaY,l-i.height.baseVal.value);return i.viewBox.baseVal.y<0&&(i.viewBox.baseVal.y=0),i.viewBox.baseVal.y>e&&(i.viewBox.baseVal.y=e),t.y.baseVal.value=i.viewBox.baseVal.y,!1}function plotClicked(e,t,l,i,a,n,o,d,r,g){if(svgDraw=getEl("svg_draw_"+t),svg=getEl("svg_"+t),null!=(closestEl=getNearestLine(e.clientX,e.clientY))){for(var s=e.offsetX-svgDraw.x.baseVal.value,e=e.offsetY-svgDraw.y.baseVal.value,x=l/svgDraw.width.baseVal.value,h=i/svgDraw.height.baseVal.value,c=(s*=x,e*=h,closestEl.points),v=s>c[c.length-1].x?c.length-1:0,p=1;p<c.length;++p){c[p].x,c[p].y;if(c[p].x>=s&&c[p-1].x<=s){v=p-1;break}}var p,f=c.length<=(f=v+1)?c.length-1:f,u=(c[p=s-c[v].x>c[f].x-s?f:v].x-s)*(c[p].x-s)+(c[p].y-e)*(c[p].y-e),u=c[v=u<36?p:v].x-c[f=u<36?p:f].x,y=c[v].y-c[f].y,b=u*u+y*y,u=u/b*(c[v].x-s)+y/b*(c[v].y-e),y=c[f].x*(u=f==v?1:u)+c[v].x*(1-u),b=c[f].y*u+c[v].y*(1-u),e=y/x+svgDraw.x.baseVal.value,f=b/h+svgDraw.y.baseVal.value,u=closestEl.id,x=u.slice(("pl_"+t).length,u.length),h=getEl("lti_"+t+x),u=getEl("pl_"+t+x),u=(lineColor=u.getAttribute("stroke"),sourceCoord=convertCoord([y,b],l,i,[a,n],[o,d],r,g),getEl("gpl_"+t+x)),y=(null==u&&(u=addSvgEl(svg,"g",{id:"gpl_"+t+x})),addSvgEl(u,"g",{class:"tooltip",transform:"translate("+e+" "+f+")"})),b=(y.onclick=e=>{"g"==e.srcElement.parentNode.tagName&&e.srcElement.parentNode.remove()},addSvgEl(y,"rect",{x:5,y:-9,stroke:"rgb(223,223,223)",fill:lineColor,rx:4,"vector-effect":"non-scaling-stroke"})),l=null,i=(null!=h&&(addSvgEl(null,text=addSvgTxt(y,h.textContent,7,-11,12,"start","Sans,Arial","white"),{"font-weight":"bold"}),l=addSvgLn(y,5,-8,5,-8,stroke="white"),b.setAttribute("y",-23)),addSvgTxt(y,"x: "+num2eng([sourceCoord[0]]),7,4,12,"start","Sans,Arial","white"),addSvgTxt(y,"y: "+num2eng([sourceCoord[1]]),7,18,12,"start","Sans,Arial","white"),y.getBBox());addSvgEl(null,b,{width:i.width+4,height:i.height+4}),null!=l&&l.setAttribute("x2",i.width+4+5),addSvgEl(y,"rect",{x:-2,y:-2,width:4,height:4,fill:"black"})}}function plotMouseDown(e,t){2==e.button&&(addSvgEl(svg=getEl("svg_"+t),"rect",{id:"zoom_rect"+t,x:e.offsetX,y:e.offsetY,height:0,width:0,fill:"black","fill-opacity":"0.3"}),svg.onmousemove=e=>plotZoom(e,t))}function plotZoom(e,t){(rectZoom=getEl("zoom_rect"+t)).width.baseVal.value=e.offsetX-rectZoom.x.baseVal.value,rectZoom.height.baseVal.value=e.offsetY-rectZoom.y.baseVal.value,2!=e.buttons&&(rectZoom.remove(),(svg=getEl("svg_"+t)).onmousemove=null)}function convertCoord(e,t,l,i,a,n,o){return x=e[0]/t*(i[1]-i[0])+i[0],y=(1-e[1]/l)*(a[1]-a[0])+a[0],x=n?Math.pow(10,x):x,y=o?Math.pow(10,y):y,[x,y]}function getNearestLine(l,i){var a=null,n=1/0;for(let t=l-4;t<=l+4;t++)for(let e=i-4;e<=i+4;e++){var o,d=document.elementFromPoint(t,e);"polyline"==d?.tagName&&(o=(t-l)*(t-l)+(e-i)*(e-i))<n&&(n=o,a=d)}return a}function plotSvg(t,e,l,i,{title:a="",subtitle:n="",xlabel:o="",ylabel:d="",xlim:r=[],ylim:g=[],legend:s=[],xScale:X="linear",yScale:x="linear",grid:B=!0,gridMinor:h=[],legendLocation:c="northeastoutside"}={}){var v=10,p=10,f=[1,2,5,10],u=["rgb(0,114,190)","rgb(218,83,25)","rgb(238,178,32)","rgb(126,47,142)","rgb(119,173,48)","rgb(77,191,239)","rgb(163,20,47)"],y=(logXEnbl=!1,"log"==X&&(e=e.map(Math.log10),1<r.length&&(r=r.map(Math.log10),isNaN(r[0])||isNaN(r[1])?r=[]:(r[0]=r[0]==-1/0?0:r[0],r[1]=r[1]==-1/0?0:r[1])),logXEnbl=!0),logYEnbl=!1,"log"==x&&(l=l.map(Math.log10),1<g.length&&(g=g.map(Math.log10),isNaN(g[0])||isNaN(g[1])?g=[]:(g[0]=g[0]==-1/0?0:g[0],g[1]=g[1]==-1/0?0:g[1])),logYEnbl=!0),e=(newPts=removeInvalidPoints([e,l]))[0],l=newPts[1],getEl(t)),b=document.createElement("div"),y=(y.appendChild(b),b.setAttribute("style","width:100%;height:calc(100vh - 16px);overflow:none"),addSvgEl(b,"svg",{id:"svg_"+t,width:"100%",height:"100%"})),b=(b=y.width.baseVal.value)<1200?1200:b,w=(w=y.height.baseVal.value)<800?800:w,m=(y.innerHTML+="<style>\n<![CDATA[\n  polyline.l {\n    stroke-width:2;\n    vector-effect:non-scaling-stroke;\n    fill:none;\n  }\n  text.cll {\n    font-size:10px;\n    fill:black;\n    dominant-baseline:middle;\n    font-family:Lucida Sans Typewriter;\n  }\n]]>\n</style>\n",0),E=48,D=a.split("\n"),z=n.split("\n"),k=(0<a.length&&(m+=28*D.length),0<n.length&&(m+=16*z.length),w-(m+=10)-24),_=b-E,O=(0<o.length&&(k=k-12-4),0<d.length&&(E=E+12+4,_=_-12-4),addSvgEl(null,"g")),Z=0;if(0<s.length&&0<i&&0<e.length){var F="";switch(c){case"northeast":yLegend=m+8,Z=16,F="white";break;case"northeastoutside":yLegend=m,F="none";break;default:throw new Error("LegendLocation not supported")}hLegendMax=k-Z,y.appendChild(O);var S=addSvgEl(y,"defs"),U=(addSvgEl(S,"line",{id:"ll_"+t,x1:0,y1:0,x2:20,y2:0,"stroke-width":2,"vector-effect":"non-scaling-stroke"}),wLegendMax=400,hLetter=10,addSvgEl(O,"svg",{id:"svg_leg_"+t})),R=i,j=s,G=(s.length>i&&(j=s.slice(0,R)),R*(hLetter+4)+4),S=G>hLegendMax?hLegendMax:G,A=(addSvgEl(null,U,{x:"100%",height:S}),addSvgEl(U,"rect",{id:"rect_leg_"+t,x:0,y:0,height:"100%",fill:F,stroke:"black","stroke-width":2,"vector-effect":"non-scaling-stroke"}));for(lineIdx=0;lineIdx<R;++lineIdx){colorIdx=lineIdx%u.length,yOffset=lineIdx*(hLetter+4)+4;var H=new addSvgEl(U,"g",{id:"lgi_"+t+"_"+lineIdx,onclick:'toggleLineVisibility("'+t+'", '+lineIdx+", 0);",ondblclick:'toggleLineVisibility("'+t+'", '+lineIdx+", "+i+");"}),q=(addSvgEl(H,"use",{id:"lli_"+t+"_"+lineIdx,x:4,y:yOffset+hLetter/2,href:"#ll_"+t,stroke:u[colorIdx]}),addSvgEl(H,"text",{id:"lti_"+t+"_"+lineIdx,class:"cll",x:28,y:yOffset+hLetter/2}));lineIdx<j.length?q.append(document.createTextNode(j[lineIdx])):q.append(document.createTextNode(""))}var L=(L=O.getBBox().width+8)>wLegendMax?wLegendMax:L;for(A.setAttribute("width","100%"),U.setAttribute("width",L),lineIdx=0;lineIdx<R;++lineIdx){colorIdx=lineIdx%u.length,yOffset=lineIdx*(hLetter+4)+4;const H=getEl("lgi_"+t+"_"+lineIdx);addSvgEl(H,"rect",{id:"lri_"+t+"_"+lineIdx,x:4,y:yOffset,width:L,height:hLetter+4,fill:"none","pointer-events":"visible"})}var J=0;switch(c){case"northeast":J=-L-8-48,_-=48;break;case"northeastoutside":J=-L,_-=L+4;break;default:throw new Error("LegendLocation not supported")}addSvgEl(null,U,{x:"calc(100% + "+J+"px)",y:yLegend,viewBox:"0 0 "+L+" "+S})}else _-=48;var M=[b-(plotArea=[E,m,_,k])[2],w-plotArea[3]],K=addSvgEl(y,"svg",{x:plotArea[0],overflow:"visible",width:"calc(100% - "+M[0]+"px)"}),T=0;if(0<a.length)for(idx=0;idx<D.length;++idx)T=T+24+4,addSvgTxt(K,D[idx],"50%",T,24);if(0<n.length)for(idx=0;idx<z.length;++idx)T=T+12+4,addSvgTxt(K,z[idx],"50%",T,12);var A=-w+plotArea[1]+plotArea[3],c=addSvgEl(y,"g",{transform:"translate("+plotArea[0]+" "+A+")"}),Q=addSvgEl(c,"svg",{overflow:"visible",y:"100%",width:"calc(100% - "+M[0]+"px)"}),W=(0<o.length&&addSvgTxt(Q,o,"50%",36,12),addSvgEl(y,"svg",{y:plotArea[1],overflow:"visible",height:"calc(100% - "+M[1]+"px)"})),I=(0<d.length&&addSvgEl(W,"text",{"writing-mode":"sideways-lr",fill:"black","font-size":12,"text-anchor":"middle","font-family":"Sans,Arial","stroke-width":1,y:"50%",x:plotArea[0]-48-4}).append(document.createTextNode(d)),0),V=0,N=0,P=0,S=(r.length<2?(I=getMin(e),V=getMax(e),NaN==I&&(I=0,V=1),I==V&&(I-=.5,V+=.5)):(I=r[0],V=r[1]),g.length<2?(N=getMin(l),P=getMax(l),NaN==N&&(N=0,P=1),N==P&&(N-=.5,P+=.5)):(N=g[0],P=g[1]),y.width.baseVal.value-M[0]),b=y.height.baseVal.value-M[1],Y=addSvgEl(y,"svg",{id:"svg_draw_"+t,preserveAspectRatio:"none",viewBox:"0 0 "+plotArea[2]+" "+plotArea[3],width:S,height:b,x:plotArea[0],y:plotArea[1]}),E=!1,k=!1,k=h.length<1?(E="log"==X,"log"==x):(E=h[0],h[1]),a=(V-I)/10,n=Math.floor(Math.log10(a)),$=Math.ceil(a/Math.pow(10,n)),w=f.findIndex(function(e){return $<=e}),a=f[w]*Math.pow(10,n),A=(logXEnbl?1<=V-I?1<(a=a<1?1:a)&&(v=v<a?v:a):v=0:v=5,(P-N)/10),n=Math.floor(Math.log10(A)),$=Math.ceil(A/Math.pow(10,n)),w=f.findIndex(function(e){return $<=e}),A=f[w]*Math.pow(10,n),c=(logYEnbl?1<=P-N?1<(A=A<1?1:A)&&(p=p<A?p:A):p=0:p=5,r.length<1&&4<=(V-I)/a&&(I=Math.floor(I/a)*a,V=Math.ceil(V/a)*a),g.length<1&&4<=(P-N)/A&&(N=Math.floor(N/A)*A,P=Math.ceil(P/A)*A),Math.ceil(I/a)*a),o=Math.floor(V/a)*a,d=Math.ceil(N/A)*A,S=Math.floor(P/A)*A,b=plotArea[2]*(c-I)/(V-I),X=plotArea[3]*(S-P)/(P-N),ee=100*(c-I)/(V-I),te=100*(S-P)/(P-N),le=Math.round((o-c)/a),ie=Math.round((S-d)/A),x=plotArea[2]>plotArea[3]?plotArea[2]/100:plotArea[3]/100,h=x/2;for(xTickLabel=logXEnbl?num2eng(decades(c,a,o)):num2eng(linspace(c,a,o)),yTickLabel=logYEnbl?num2eng(decades(d,A,S)):num2eng(linspace(d,A,S)),dXTick=plotArea[2]*a/(V-I),dXTickPct=100*a/(V-I),dYTick=plotArea[3]*A/(P-N),dYTickPct=100*A/(P-N),idx=0;idx<=ie;++idx){var ae=-te+dYTickPct*idx;(q=addSvgTxt(W,yTickLabel[ie-idx],plotArea[0]-6,ae+"%",12,"end")).setAttribute("alignment-baseline","middle")}for(idx=0;idx<=le;++idx){var ne=dXTickPct*idx+ee;addSvgTxt(Q,xTickLabel[idx],ne+"%",12*1.4,12)}var f=addSvgEl(Y,"defs"),oe=(k&&0<p&&(w=addSvgEl(f,"g",{id:"mgy_"+t}),B&&addSvgLn(w,0,1,plotArea[2],1,stroke="rgb(223,223,223)",strokedasharray="2 4"),addSvgLn(w,0,1,h,1),addSvgLn(w,plotArea[2]-h,1,plotArea[2],1),f.appendChild(w)),addSvgEl(f,"pattern",{id:"yTick_"+t,x:0,y:X-1,width:plotArea[2],height:dYTick,patternUnits:"userSpaceOnUse"}));if(k&&0<p)for(logYEnbl&&1==A?(minorTickPos=logspace(1,9/(p-1),10)).forEach((e,t)=>{minorTickPos[t]=(1-minorTickPos[t])*dYTick}):minorTickPos=linspace(0,1/p*dYTick,dYTick),idx=1;idx<minorTickPos.length-1;++idx)addSvgEl(oe,"use",{href:"#mgy_"+t,y:minorTickPos[idx]});B&&addSvgLn(oe,0,1,plotArea[2],1,stroke="rgb(223,223,223)"),addSvgLn(oe,0,1,x,1),addSvgLn(oe,plotArea[2]-x,1,plotArea[2],1),addSvgEl(Y,"rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"url(#yTick_"+t+")"});var n=addSvgEl(Y,"defs"),de=(E&&0<v&&(r=addSvgEl(n,"g",{id:"mgx_"+t}),B&&addSvgLn(r,1,0,1,plotArea[3],stroke="rgb(223,223,223)",strokedasharray="2 4"),addSvgLn(r,1,0,1,h),addSvgLn(r,1,plotArea[3]-h,1,plotArea[3])),addSvgEl(n,"pattern",{id:"xTick_"+t,x:b-1,y:0,width:dXTick,height:plotArea[3],patternUnits:"userSpaceOnUse"}));if(E&&0<v)for(logXEnbl&&1==a?(minorTickPos=logspace(1,9/(v-1),10)).forEach((e,t)=>{minorTickPos[t]*=dXTick}):minorTickPos=linspace(0,1/v*dXTick,dXTick),idx=1;idx<minorTickPos.length-1;++idx)addSvgEl(de,"use",{href:"#mgx_"+t,x:minorTickPos[idx],"vector-effect":"non-scaling-stroke"});B&&addSvgLn(de,1,0,1,plotArea[3],stroke="rgb(223,223,223)"),addSvgLn(de,1,0,1,x),addSvgLn(de,1,plotArea[3]-x,1,plotArea[3]),addSvgEl(Y,"rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"url(#xTick_"+t+")"});var re=l.length/i,ge=e.length==l.length;if(!ge&&re!=e.length)throw new Error("Dimension must agree");for(lineIdx=0;lineIdx<i;++lineIdx){var C=e.length,se=new Array(2*C);for(colorIdx=lineIdx%u.length,ptIdx=0;ptIdx<re;++ptIdx){var xe=ge?e[lineIdx*re+ptIdx]:e[ptIdx],he=l[lineIdx*re+ptIdx];se[2*ptIdx]=plotArea[2]*(xe-I)/(V-I),se[2*ptIdx+1]=plotArea[3]-plotArea[3]*(he-N)/(P-N)}C=document.createElementNS("http://www.w3.org/2000/svg","polyline");C.setAttribute("class","l"),C.setAttribute("id","pl_"+t+"_"+lineIdx),C.setAttribute("points",se.join(" ")),C.setAttribute("stroke",u[colorIdx]),Y.appendChild(C)}addSvgEl(Y,"rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"none",stroke:"black","stroke-width":2,"vector-effect":"non-scaling-stroke"}),y.appendChild(O),Y.onclick=e=>plotClicked(e,t,plotArea[2],plotArea[3],I,V,N,P,logXEnbl,logYEnbl),y.oncontextmenu=e=>{e.preventDefault()},Y.onmousedown=e=>plotMouseDown(e,t),y.onmousedown=e=>{e.preventDefault()},0<s.length&&(O.onwheel=e=>scrollLegend(e,t,G)),new ResizeObserver(()=>resizeSvg(t,M[0],M[1],G,Z)).observe(y)}