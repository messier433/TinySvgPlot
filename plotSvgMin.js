function gE(e){return document.getElementById(e)}function gM(e){let t=e.length,l=-1/0;for(;t--;)l=e[t]>l&&isFinite(e[t])?e[t]:l;return l}function gMi(e){let t=e.length,l=1/0;for(;t--;)l=e[t]<l&&isFinite(e[t])?e[t]:l;return l}function n2e(t){var l=["y","z","a","f","p","n","u","m","","k","M","G","T","P","E","Z","Y"],a=Array(t.length);for(idx=0;idx<t.length;++idx){var i=t[idx].toExponential(5).split(/e/);let e=Math.floor(+i[1]/3)+8;e>l.length-1?e=l.length-1:e<0&&(e=0),a[idx]=Math.round(i[0]*Math.pow(10,+i[1]-3*(e-8))*1e3)/1e3+l[e]}return a}function lis(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0;idx<numel;++idx)out[idx]=e+t*idx;return out}function los(e,t,l){return lis(e,t,l).map(Math.log10)}function dec(e,t,l){return lis(e,t,l).map(e=>10**e)}function aSE(e,t,l){var a,i="string"==typeof t?document.createElementNS("http://www.w3.org/2000/svg",t):t;for(a in l)i.setAttribute(a,l[a]);return null!=e&&e.appendChild(i),i}function aST(e,t,l,a,i,n="middle",o="Sans,Arial",r="black"){e=aSE(e,"text",{x:l,y:a,fill:r,"font-size":i,"text-anchor":n,"font-family":o,"stroke-width":1});return e.append(document.createTextNode(t)),e}function aSL(e,t,l,a,i,n="black",o=""){return aSE(e,"line",{x1:t,y1:l,x2:a,y2:i,stroke:n,"stroke-width":1,"stroke-dasharray":o,"vector-effect":"non-scaling-stroke"})}function addSvgRec(e,t,l,a,i,n="none",o="none",r=2,s=0){return aSE(e,"rect",{x:t,y:l,width:a,height:i,rx:s,stroke:o,"stroke-width":r,fill:n,"vector-effect":"non-scaling-stroke"})}function legClk(e,t,l,a,i){var n=gE("svg_leg_"+a),e=e.offsetY-n.y.baseVal.value,o=Math.floor((e-l/2)/(t+l)),n=gE("pl_"+a+"_"+o);if(null!=n){var r=n.style.display;if(0==i){e=gE("gpl_"+a+"_"+o);"none"===r?(gE("pl_"+a+"_"+o).style.display="block",gE("lgi_"+a+"_"+o).style.opacity=1,null!=e&&(e.style.display="block")):(gE("pl_"+a+"_"+o).style.display="none",gE("lgi_"+a+"_"+o).style.opacity=.3,null!=e&&(e.style.display="none"))}else for(idx=0;idx<i;++idx){var s=gE("gpl_"+a+"_"+idx);"none"===r?(gE("pl_"+a+"_"+idx).style.display="block",gE("lgi_"+a+"_"+idx).style.opacity=1,null!=s&&(s.style.display="block")):idx!=o&&(gE("pl_"+a+"_"+idx).style.display="none",gE("lgi_"+a+"_"+idx).style.opacity=.3,null!=s)&&(s.style.display="none")}}}function rS(e,t,l,a,i){var n=gE("svg_leg_"+e),o=gE("svg_draw_"+e),r=gE("svg_top_"+e),s=gE("svg_bottom_"+e),d=gE("svg_left_"+e),e=gE("svg_"+e),g=e.width.baseVal.value-t,h=e.height.baseVal.value-l,c=o.width.baseVal.value,x=o.height.baseVal.value;if(tooltips=document.getElementsByClassName("tooltip"),c!=g)for(o.width.baseVal.value=g,r.width.baseVal.value=g,s.width.baseVal.value=g,n.x.baseVal.value+=g-c,idx=0;idx<tooltips.length;++idx){var u=o.x.baseVal.value,v=tooltips[idx].transform.baseVal[0].matrix.e;tooltips[idx].transform.baseVal[0].matrix.e=u+(v-u)*g/c}if(x!=h)for(o.height.baseVal.value=h,d.height.baseVal.value=h,null!=n&&(n.height.baseVal.value=t=a<(t=h-i)?a:t,n.viewBox.baseVal.height=t),idx=0;idx<tooltips.length;++idx){var f=o.y.baseVal.value,p=tooltips[idx].transform.baseVal[0].matrix.f;tooltips[idx].transform.baseVal[0].matrix.f=f+(p-f)*h/x}}function sL(e,t,l){var a=gE("svg_leg_"+t),t=gE("rect_leg_"+t),e=(a.viewBox.baseVal.y+=e.deltaY,l-a.height.baseVal.value);return a.viewBox.baseVal.y<0&&(a.viewBox.baseVal.y=0),a.viewBox.baseVal.y>e&&(a.viewBox.baseVal.y=e),t.y.baseVal.value=a.viewBox.baseVal.y,!1}function pC(e,t,l,a,i,n,o,r,s,d){if(svgDraw=gE("svg_draw_"+t),svg=gE("svg_"+t),null!=(closestEl=gNL(e.clientX,e.clientY))){for(var g=e.offsetX-svgDraw.x.baseVal.value,e=e.offsetY-svgDraw.y.baseVal.value,h=l/svgDraw.width.baseVal.value,c=a/svgDraw.height.baseVal.value,x=(g*=h,e*=c,closestEl.points),u=g>x[x.length-1].x?x.length-1:0,v=1;v<x.length;++v){x[v].x,x[v].y;if(x[v].x>=g&&x[v-1].x<=g){u=v-1;break}}var v,f=x.length<=(f=u+1)?x.length-1:f,p=(x[v=g-x[u].x>x[f].x-g?f:u].x-g)*(x[v].x-g)+(x[v].y-e)*(x[v].y-e),p=x[u=p<36?v:u].x-x[f=p<36?v:f].x,b=x[u].y-x[f].y,y=p*p+b*b,p=p/y*(x[u].x-g)+b/y*(x[u].y-e),b=x[f].x*(p=f==u?1:p)+x[u].x*(1-p),y=x[f].y*p+x[u].y*(1-p),e=b/h+svgDraw.x.baseVal.value,f=y/c+svgDraw.y.baseVal.value,p=closestEl.id,h=p.slice(("pl_"+t).length,p.length),c=gE("lti_"+t+h),p=gE("pl_"+t+h),p=(lineColor=p.getAttribute("stroke"),sourceCoord=cC([b,y],l,a,[i,n],[o,r],s,d),gE("gpl_"+t+h)),b=(null==p&&(p=aSE(svg,"g",{id:"gpl_"+t+h})),aSE(p,"g",{class:"tooltip",transform:"translate("+e+" "+f+")"})),y=(b.onclick=e=>{"g"==e.srcElement.parentNode.tagName&&e.srcElement.parentNode.remove()},addSvgRec(b,5,-9,0,32,lineColor,"rgb(223,223,223)",1,rx=4)),l=null,a=(null!=c&&(aSE(null,text=aST(b,c.textContent,7,-11,12,"start","Sans,Arial","white"),{"font-weight":"bold"}),l=aSL(b,5,-8,5,-8,stroke="white"),aSE(null,y,{y:-23,height:46})),aST(b,"x: "+n2e([sourceCoord[0]]),7,4,12,"start","Sans,Arial","white"),aST(b,"y: "+n2e([sourceCoord[1]]),7,18,12,"start","Sans,Arial","white"),b.getBBox());aSE(null,y,{width:a.width+4}),null!=l&&l.setAttribute("x2",a.width+4+5),addSvgRec(b,-2,-2,4,4,"black")}}function pM(e,t){2==e.button&&(aSE(null,addSvgRec(svg=gE("svg_"+t),e.offsetX,e.offsetY,0,0,"black"),{id:"zoom_rect"+t,"fill-opacity":"0.3"}),svg.onmousemove=e=>pZ(e,t))}function pZ(e,t){(rectZoom=gE("zoom_rect"+t)).width.baseVal.value=e.offsetX-rectZoom.x.baseVal.value,rectZoom.height.baseVal.value=e.offsetY-rectZoom.y.baseVal.value,2!=e.buttons&&(rectZoom.remove(),(svg=gE("svg_"+t)).onmousemove=null)}function cC(e,t,l,a,i,n,o){return x=e[0]/t*(a[1]-a[0])+a[0],y=(1-e[1]/l)*(i[1]-i[0])+i[0],x=n?Math.pow(10,x):x,y=o?Math.pow(10,y):y,[x,y]}function gNL(l,a){var i=null,n=1/0;for(let t=l-4;t<=l+4;t++)for(let e=a-4;e<=a+4;e++){var o,r=document.elementFromPoint(t,e);"polyline"==r?.tagName&&(o=(t-l)*(t-l)+(e-a)*(e-a))<n&&(n=o,i=r)}return i}function plotSvg(t,e,l,a,{title:i="",subtitle:n="",xlabel:o="",ylabel:r="",xlim:s=[],ylim:d=[],legend:g=[],xScale:X="lin",yScale:B="lin",grid:D=!0,gridMinor:R=[],legendLocation:h="northeastoutside"}={}){var c=10,x=10,u=[1,2,5,10],v=["rgb(0,114,190)","rgb(218,83,25)","rgb(238,178,32)","rgb(126,47,142)","rgb(119,173,48)","rgb(77,191,239)","rgb(163,20,47)"],f=(logXEnbl=!1,"log"==X&&(e=e.map(Math.log10),1<s.length&&(s=s.map(Math.log10),isNaN(s[0])||isNaN(s[1])?s=[]:(s[0]=s[0]==-1/0?0:s[0],s[1]=s[1]==-1/0?0:s[1])),logXEnbl=!0),logYEnbl=!1,"log"==B&&(l=l.map(Math.log10),1<d.length&&(d=d.map(Math.log10),isNaN(d[0])||isNaN(d[1])?d=[]:(d[0]=d[0]==-1/0?0:d[0],d[1]=d[1]==-1/0?0:d[1])),logYEnbl=!0),gE(t)),p=document.createElement("div"),f=(f.appendChild(p),p.setAttribute("style","width:100%;height:calc(100vh - 16px);overflow:none"),aSE(p,"svg",{id:"svg_"+t,width:"100%",height:"100%"})),p=(p=f.width.baseVal.value)<1200?1200:p,b=(b=f.height.baseVal.value)<800?800:b,y=(f.innerHTML+="<style>\n<![CDATA[\n  polyline.l {\n    stroke-width:2;\n    vector-effect:non-scaling-stroke;\n    fill:none;\n  }\n  text.cll {\n    font-size:10px;\n    fill:black;\n    dominant-baseline:central;\n    font-family:Lucida Sans Typewriter;\n  }\n]]>\n</style>\n",0),w=48,Z=i.split("\n"),z=n.split("\n"),E=(0<i.length&&(y+=28*Z.length),0<n.length&&(y+=16*z.length),b-(y+=10)-24),m=p-w,_=(0<o.length&&(E=E-12-4),0<r.length&&(w=w+12+4,m=m-12-4),aSE(null,"g",{"pointer-events":"visible"})),F=(_.onclick=e=>legClk(e,hLetter,4,t,0),_.ondblclick=e=>legClk(e,hLetter,4,t,a),0);if(0<g.length&&0<a&&0<e.length){var O="";switch(h){case"northeast":yLegend=y+8,F=16,O="white";break;case"northeastoutside":yLegend=y,O="none";break;default:throw new Error("LegendLocation not supported")}hLegendMax=E-F,f.appendChild(_);var k=aSE(f,"defs"),S=(aSE(k,"line",{id:"ll_"+t,x1:0,y1:0,x2:20,y2:0,"stroke-width":2,"vector-effect":"non-scaling-stroke"}),wLegendMax=400,hLetter=10,aSE(_,"svg",{id:"svg_leg_"+t})),G=a,H=g,j=(g.length>a&&(H=g.slice(0,G)),G*(hLetter+4)+4),k=j>hLegendMax?hLegendMax:j,M=(aSE(null,S,{x:"100%",height:k}),addSvgRec(S,0,0,0,"100%",O,"black"));for(aSE(null,M,{id:"rect_leg_"+t}),lnIdx=0;lnIdx<G;++lnIdx){colorIdx=lnIdx%v.length,yOffset=lnIdx*(hLetter+4)+4;var q=new aSE(S,"g",{id:"lgi_"+t+"_"+lnIdx}),J=(aSE(q,"use",{id:"lli_"+t+"_"+lnIdx,x:4,y:yOffset+hLetter/2,href:"#ll_"+t,stroke:v[colorIdx]}),aSE(q,"text",{id:"lti_"+t+"_"+lnIdx,class:"cll",x:28,y:yOffset+hLetter/2})),q="";lnIdx<H.length&&(q=H[lnIdx]),J.append(document.createTextNode(q))}var T=(T=_.getBBox().width+8)>wLegendMax?wLegendMax:T,K=(M.setAttribute("width","100%"),S.setAttribute("width",T),0);switch(h){case"northeast":K=-T-8-48,m-=48;break;case"northeastoutside":K=-T,m-=T+4;break;default:throw new Error("LegendLocation not supported")}aSE(null,S,{x:f.width.baseVal.value+K,y:yLegend,viewBox:"0 0 "+T+" "+k})}else m-=48;var V=[p-(pltAr=[w,y,m,E])[2],b-pltAr[3]],Q=aSE(f,"svg",{id:"svg_top_"+t,x:pltAr[0],overflow:"visible",width:f.width.baseVal.value-V[0]}),A=0;if(0<i.length)for(idx=0;idx<Z.length;++idx)A=A+24+4,aST(Q,Z[idx],"50%",A,24);if(0<n.length)for(idx=0;idx<z.length;++idx)A=A+12+4,aST(Q,z[idx],"50%",A,12);var M=-b+pltAr[1]+pltAr[3],h=aSE(f,"g",{transform:"translate("+pltAr[0]+" "+M+")"}),U=aSE(h,"svg",{id:"svg_bottom_"+t,overflow:"visible",y:"100%",width:f.width.baseVal.value-V[0]}),W=(0<o.length&&aST(U,o,"50%",36,12),aSE(f,"svg",{id:"svg_left_"+t,y:pltAr[1],overflow:"visible",height:f.height.baseVal.value-V[1]})),L=(0<r.length&&aSE(W,"text",{"writing-mode":"sideways-lr",fill:"black","font-size":12,"text-anchor":"middle","font-family":"Sans,Arial","stroke-width":1,y:"50%",x:pltAr[0]-48-4}).append(document.createTextNode(r)),0),I=0,C=0,N=0,k=(s.length<2?(L=gMi(e),I=gM(e),L==I&&(L-=.5,I+=.5)):(L=s[0],I=s[1]),d.length<2?(C=gMi(l),N=gM(l),C==N&&(C-=.5,N+=.5)):(C=d[0],N=d[1]),f.width.baseVal.value-V[0]),p=f.height.baseVal.value-V[1],P=aSE(f,"svg",{id:"svg_draw_"+t,preserveAspectRatio:"none",viewBox:"0 0 "+pltAr[2]+" "+pltAr[3],width:k,height:p,x:pltAr[0],y:pltAr[1]}),w=!1,E=!1,E=R.length<1?(w="log"==X,"log"==B):(w=R[0],R[1]),i=(I-L)/10,n=Math.floor(Math.log10(i)),$=Math.ceil(i/Math.pow(10,n)),b=u.findIndex(function(e){return $<=e}),i=u[b]*Math.pow(10,n),M=(logXEnbl?1<=I-L?1<(i=i<1?1:i)&&(c=c<i?c:i):c=0:c=5,(N-C)/10),n=Math.floor(Math.log10(M)),$=Math.ceil(M/Math.pow(10,n)),b=u.findIndex(function(e){return $<=e}),M=u[b]*Math.pow(10,n),h=(logYEnbl?1<=N-C?1<(M=M<1?1:M)&&(x=x<M?x:M):x=0:x=5,s.length<1&&4<=(I-L)/i&&(L=Math.floor(L/i)*i,I=Math.ceil(I/i)*i),d.length<1&&4<=(N-C)/M&&(C=Math.floor(C/M)*M,N=Math.ceil(N/M)*M),Math.ceil(L/i)*i),o=Math.floor(I/i)*i,r=Math.ceil(C/M)*M,k=Math.floor(N/M)*M,ee=pltAr[2]*(h-L)/(I-L),te=pltAr[3]*(k-N)/(N-C),le=100*(h-L)/(I-L),ae=100*(k-N)/(N-C),ie=Math.round((o-h)/i),ne=Math.round((k-r)/M),p=(xTickLabel=logXEnbl?n2e(dec(h,i,o)):n2e(lis(h,i,o)),yTickLabel=logYEnbl?n2e(dec(r,M,k)):n2e(lis(r,M,k)),dXTick=pltAr[2]*i/(I-L),dXTickPct=100*i/(I-L),dYTick=pltAr[3]*M/(N-C),dYTickPct=100*M/(N-C),aSE(P,"defs")),oe=aSE(p,"g",{id:"mgy_"+t});if(E&&0<x)for(logYEnbl&&1==M?(minorTickPos=los(1,9/(x-1),10)).forEach((e,t)=>{minorTickPos[t]=(1-minorTickPos[t])*dYTick}):minorTickPos=lis(0,1/x*dYTick,dYTick),idx=1;idx<minorTickPos.length-1;++idx)aSL(oe,0,minorTickPos[idx],"100%",minorTickPos[idx],"rgb(223,223,223)","2 4");for(D&&aSL(oe,0,0,"100%",0,"rgb(223,223,223)"),aSL(oe,0,0,"1%",0),aSL(oe,"99%",0,"100%",0),idx=0;idx<=ne;++idx){var re=-ae+dYTickPct*idx,se=-te+dYTick*idx;(J=aST(W,yTickLabel[ne-idx],pltAr[0]-6,re+"%",12,"end")).setAttribute("dominant-baseline","central"),aSE(P,"use",{href:"#mgy_"+t,y:se})}var X=aSE(P,"defs"),de=aSE(X,"g",{id:"mgx_"+t});if(w&&0<c)for(logXEnbl&&1==i?(minorTickPos=los(1,9/(c-1),10)).forEach((e,t)=>{minorTickPos[t]*=dXTick}):minorTickPos=lis(0,1/c*dXTick,dXTick),idx=1;idx<minorTickPos.length-1;++idx)aSL(de,minorTickPos[idx],0,minorTickPos[idx],"100%","rgb(223,223,223)","2 4");for(D&&aSL(de,0,0,0,"100%","rgb(223,223,223)"),aSL(de,0,0,0,"1%"),aSL(de,0,"99%",0,"100%"),idx=0;idx<=ie;++idx){var ge=dXTickPct*idx+le,he=dXTick*idx+ee;aST(U,xTickLabel[idx],ge+"%",12*1.4,12),aSE(P,"use",{href:"#mgx_"+t,x:he})}var ce=l.length/a,xe=e.length==l.length;if(!xe&&ce!=e.length)throw new Error("Dimension must agree");for(lnIdx=0;lnIdx<a;++lnIdx){var ue=e.length,Y=(new Array(2*ue),colorIdx=lnIdx%v.length,document.createElementNS("http://www.w3.org/2000/svg","polyline"));for(Y.setAttribute("class","l"),Y.setAttribute("id","pl_"+t+"_"+lnIdx),Y.setAttribute("stroke",v[colorIdx]),ptIdx=0;ptIdx<ce;++ptIdx){var ve,fe=xe?e[lnIdx*ce+ptIdx]:e[ptIdx],pe=l[lnIdx*ce+ptIdx];isFinite(fe)&&isFinite(pe)&&((ve=P.createSVGPoint()).x=pltAr[2]*(fe-L)/(I-L),ve.y=pltAr[3]-pltAr[3]*(pe-C)/(N-C),Y.points.appendItem(ve))}P.appendChild(Y)}addSvgRec(P,0,0,pltAr[2],pltAr[3],"none","black"),f.appendChild(_),P.onclick=e=>pC(e,t,pltAr[2],pltAr[3],L,I,C,N,logXEnbl,logYEnbl),f.oncontextmenu=e=>{e.preventDefault()},P.onmousedown=e=>pM(e,t),f.onmousedown=e=>{e.preventDefault()},0<g.length&&(_.onwheel=e=>sL(e,t,j)),new ResizeObserver(()=>rS(t,V[0],V[1],j,F)).observe(f)}