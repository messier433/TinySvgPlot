{const a=Math.round,b=Math.floor,c=Math.log10,d=Math.ceil,e=1/0,f=document,g=2,h=1,i=12,j=10,k="Lucida Sans Typewriter",l=20,m=4,n=4,o=400,p=4,q=24,r=12,s=[10,10],t=[10,10],u=[1,2,5,10],v=4*i,w=2*i,x=["rgb(0,114,190)","rgb(218,83,25)","rgb(238,178,32)","rgb(126,47,142)","rgb(119,173,48)","rgb(77,191,239)","rgb(163,20,47)"],y="http://www.w3.org/2000/svg";function plotSvg(_,B,A,V,{title:se="",subtitle:N="",xlabel:S="",ylabel:ae="",xlim:E=[],ylim:T=[],style:ce="-",marker:he="",legend:z=[],xScale:ge="lin",yScale:ue="lin",grid:fe=!0,gridMinor:de=[],legendLocation:M="northeastoutside",linTip:ye=!0}={}){let C=[!1,!1];"log"==ge&&(B=B.map(c),1<E.length&&(E=E.map(c),isNaN(E[0])||isNaN(E[1])?E=[]:(E[0]=E[0]==-e?0:E[0],E[1]=E[1]==-e?0:E[1])),C[0]=!0),"log"==ue&&(A=A.map(c),1<T.length&&(T=T.map(c),isNaN(T[0])||isNaN(T[1])?T=[]:(T[0]=T[0]==-e?0:T[0],T[1]=T[1]==-e?0:T[1])),C[1]=!0);var L=Q(_);const Y=f.createElement("div"),R=(ne(L,Y),$(Y,"style","width:100%;height:100%;min-width:"+o+"px;min-height:200px;overflow:none"),ne(Y,"svg",{id:"s_"+_,width:"100%",height:"100%"}));L=te(R);R.innerHTML+="<style>\n<![CDATA[\ntext.cll {\nfont-size:"+j+"px;\nfill:black;\ndominant-baseline:central;\nfont-family:"+k+";\n}\n.b:hover polyline{\nopacity:0.5;\n}\n]]>\n</style>\n";let D=0,ve=v;var xe=se.split("\n"),pe=N.split("\n");0<se.length&&(D+=(q+p)*xe.length),0<N.length&&(D+=(r+p)*pe.length),D=D<19?25:D+6;let me=L[3]-D-w,U=L[2]-ve;0<S.length&&(me=me-i-p),0<ae.length&&(ve=ve+i+2*p,U=U-i-2*p);var X=ne(null,"g",{"pointer-events":"visible"});X.onclick=e=>Ke(e,0),X.ondblclick=e=>Ke(e,V);let be=0,F=0,we="none",H=null,ke=null;if(0<z.length&&0<V&&0<B.length){let e=D;"northeast"==M&&(e=D+2*n,be=4*n,we="white");var I=me-be,O=ne(R,"defs"),_e=(H=ne(X,"svg",{id:"sl_"+_}),ne(R,X),ne(O,"line",{id:"ll_"+_,x1:0,y1:0,x2:l,y2:0,"stroke-width":2,"vector-effect":"non-scaling-stroke"}),V);let r=z;z.length>V&&(r=z.slice(0,_e));O=(F=_e*(j+n)+n)>I?I:F;ne(null,H,{x:"100%",height:O}),ne(null,ke=oe(H,0,0,0,"100%",we,"black"),{id:"rect_leg_"+_});for(let t=0;t<_e;++t){var Be=t%x.length,Ae=t*(j+n)+n,Ve=new ne(H,"g",{id:"lgi_"+_+"_"+t}),Be=(ne(Ve,"use",{id:"lli_"+_+"_"+t,x:m,y:Ae+j/2,href:"#ll_"+_,stroke:x[Be]}),ne(Ve,"text",{id:"lti_"+_+"_"+t,class:"cll",x:m+l+m,y:Ae+j/2}));let e="";t<r.length&&(e=r[t]),Be.append(f.createTextNode(e))}I=(I=X.getBBox().width+2*m)>o?o:I;$(ke,"width","100%"),$(H,"width",I);let t=-I-m;U-=I+2*m,"northeast"==M&&(t-=m+v,U-=v-I-2*m),ne(null,H,{x:L[2]+t,y:e,viewBox:"0 0 "+I+" "+O})}else U-=v;M=[ve,D,U,me];let Ne=[L[2]-M[2],L[3]-M[3]];const Se=ne(R,"svg",{id:"st_"+_,x:M[0],overflow:"visible",width:M[2]});let G=0;if(0<se.length)for(let e=0;e<xe.length;++e)G=G+q+p,re(Se,xe[e],"50%",G,q);if(0<N.length)for(let e=0;e<pe.length;++e)G=G+r+p,re(Se,pe[e],"50%",G,r);I=-L[3]+M[1]+M[3],O=ne(R,"g");le(O,[M[0],I]);const Ee=ne(O,"svg",{id:"s_btm_"+_,overflow:"visible",y:"100%",width:M[2]}),Te=(0<S.length&&re(Ee,S,"50%",3*i,i),ne(R,"svg",{id:"sy_"+_,width:M[0],y:M[1],overflow:"visible",height:M[3]}));0<ae.length&&ne(Te,"text",{"writing-mode":"sideways-lr",fill:"black","font-size":i,"text-anchor":"middle","font-family":"Sans,Arial","stroke-width":1,y:"50%",x:M[0]-4*i-p}).append(f.createTextNode(ae));N=je(B,E),L=je(A,T);let K=[N[0],L[0],N[1]-N[0],L[1]-L[0]];const ze=ne(R,"svg",{id:"s_bg_"+_,preserveAspectRatio:"none",viewBox:"0 0 100 100",width:M[2],height:M[3],x:M[0],y:M[1]}),P=ne(R,"svg",{id:"sd_"+_,preserveAspectRatio:"none",viewBox:"0 0 100 100",width:M[2],height:M[3],x:M[0],y:M[1]});let W=[!(P.style.cursor="crosshair"),!1];de.length<1?(W[0]="log"==ge,W[1]="log"==ue):(W[0]=de[0],W[1]=de[1]);I=Je(K[2],s[0],C[0]),O=Je(K[3],s[1],C[1]);E.length<1&&4<=K[2]/I&&(K[0]=b(N[0]/I)*I,K[2]=d(N[1]/I)*I-K[0]),T.length<1&&4<=K[3]/O&&(K[1]=b(L[0]/O)*O,K[3]=d(L[1]/O)*O-K[1]),Ze(K);const Me=ne(P,"defs");""!=he&&(J("o",[ne(null,"circle",{r:"5"})],1),J("+",[ie(null,0,-5,0,5,"","",""),ie(null,-5,0,5,0,"","","")]),J("*",[ie(null,0,-5,0,5,"","",""),ie(null,-5,0,5,0,"","",""),ie(null,-3.5,-3.5,3.5,3.5,"","",""),ie(null,-3.5,3.5,3.5,-3.5,"","","")]),J(".",[ne(null,"circle",{r:"1.5","stroke-width":3})]),J("x",[ie(null,-3.5,-3.5,3.5,3.5,"","",""),ie(null,-3.5,3.5,3.5,-3.5,"","","")]),J("_",[ie(null,-5,0,5,0,"","","")]),J("|",[ie(null,0,-5,0,5,"","","")]),J("sq",[oe(null,-5,-5,10,10,"","","")],1),J("^",[ne(null,"polygon",{points:"-5 3, 0 -5, 5 3"})],1),J("v",[ne(null,"polygon",{points:"-5 -4, 0 5, 5 -4"})],1),J("tr",[ne(null,"polygon",{points:"-3 -5, 5 0, -3 5"})],1),J("tl",[ne(null,"polygon",{points:"-5 0, 3 5, 3 -5"})],1));var Ce=A.length/V,Le=B.length==A.length;if(!Le&&Ce!=B.length)throw new Error("Dimension must agree");var Ye=ne(P,"g",{id:"gp_"+_});for(let l=0;l<V;++l){var Re=l%x.length,De=Array.isArray(ce)?ce[l]:ce,Ue="url(#m"+(Array.isArray(he)?he[l]:he)+"_"+_+")";let e="",t=2;switch(De){case":":e="2 3";break;case"--":e="12 6";break;case"-.":e="9 3 3 3";break;case"*":t=0}var Xe=ne(Ye,"polyline",{class:"l",id:"pl_"+_+"_"+l,stroke:x[Re],"stroke-dasharray":e,"marker-start":Ue,"marker-mid":Ue,"marker-end":Ue,"stroke-width":t,"vector-effect":"non-scaling-stroke",fill:"none"});for(let e=0;e<Ce;++e){var Fe,He=Le?B[l*Ce+e]:B[e],Ie=A[l*Ce+e];isFinite(He)&&isFinite(Ie)&&((Fe=P.createSVGPoint()).x=100*(He-K[0])/K[2],Fe.y=100-100*(Ie-K[1])/K[3],Xe.points.appendItem(Fe))}}S=oe(P,0,0,"100%","100%","none","black");const Oe=ne(null,S,{id:"plr_"+_,"pointer-events":"visible"}),Z=("white"==we&&ne(R,X),ne(Se,"g",{id:"bd_"+_,"stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round",class:"b","pointer-events":"visible"}));function je(r,i){if(i.length<2){let t=r.length,l=-e,n=e;for(;t--;)isFinite(r[t])&&(n=r[t]<n?r[t]:n,l=r[t]>l?r[t]:l);i=[n,l]}return i[0]==i[1]&&(i[0]=i[0]-.5,i[1]=i[1]+.5),i}function J(e,t,l=0){var n=ne(Me,"marker",{id:"m"+e+"_"+_,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"userSpaceOnUse",fill:"none",stroke:"context-stroke"}),r=ne(n,"g",{"stroke-width":1.5,"vector-effect":"non-scaling-stroke",class:"marker_"+_});le(r,[5,5],[1,1]);for(let e=0;e<t.length;++e)ne(r,t[e]);l&&ne(Me,n.cloneNode(!0),{id:"mf"+e+"_"+_,fill:"context-stroke"})}function Ge(e,t,l=0){var n=Q("gpl_"+e+"_"+t),r=l?"block":"none";Q("pl_"+e+"_"+t).style.display=r,Q("lgi_"+e+"_"+t).style.opacity=.3+.7*l,null!=n&&(n.style.display=r)}function Ke(e,t){var e=e.offsetY-ee(H,"y")+tt(H)[1],l=b((e-n/2)/(j+n)),e=Q("pl_"+_+"_"+l);if(null!=e){var r="none"!=e.style.display,i=0==t?l+1:t;for(let e=0==t?l:0;e<i;++e)r?e==l&&0!=t||Ge(_,e):Ge(_,e,1)}}function Pe(){var e=te(R),t=te(P),l=e[2]-Ne[0],e=e[3]-Ne[1];t[2]!=l&&($(P,"width",l),$(ze,"width",l),$(Se,"width",l),$(Ee,"width",l),null!=H&&(H.x.baseVal.value+=l-t[2]),Z.transform.baseVal[0].matrix.e+=l-t[2]),t[3]!=e&&($(P,"height",e),$(ze,"height",e),$(Te,"height",e),null!=H)&&(l=(l=e-be)>F?F:l,$(H,"height",l),H.viewBox.baseVal.height=l),qe()}function qe(){var t=f.getElementsByClassName("marker_"+_);for(let e=0;e<t.length;++e){var l=te(P),n=tt(P),r=n[2]/l[2],n=n[3]/l[3];t[e].transform.baseVal[1].matrix.a=r,t[e].transform.baseVal[1].matrix.d=n}}function We(e){for(var t=100*(e[0]-K[0])/K[2],l=100*(K[1]+K[3]-e[1]-e[3])/K[3],n=(P.viewBox.baseVal.width=100*e[2]/K[2],P.viewBox.baseVal.height=100*e[3]/K[3],P.viewBox.baseVal.x=t,P.viewBox.baseVal.y=l,ne(null,Oe,{x:t,y:l}),f.getElementsByClassName("cg_"+_));0<n.length;)n[0].remove();Ze(e),qe()}function Ze(e){for(let r=0;r<2;++r){var o=0<r?Te:Ee,h=Je(e[2+r],s[r],C[r]),g=e[r]+e[2+r],l=d(e[r]/h)*h,g=b(g/h)*h,u=100*(0<r?e[r]+e[r+2]-g:l-e[r])/e[2+r],f=a((g-l)/h);let n=Array();n=C[r]?et($e(l,h,g).map(e=>10**e)):et($e(l,h,g));const x=100*h/e[2+r];var l=ne(ze,"defs",{class:"cg_"+_}),y=ne(l,"g",{id:"mg"+r+"_"+_}),g=C[r]||W[r]?t[r]:0;if(0<g){let l=Array();C[r]&&1==h?(l=$e(1,9/(g-1),10).map(c)).forEach((e,t)=>{l[t]=l[t]*x}):l=$e(0,2/g*x,x);for(let e=1;e<l.length-1;++e)Qe(y,0<r?x-l[e]:l[e],r,4,"2 4")}Qe(y,0,r,8,"");for(let l=-1;l<=f;++l){var v=u+x*l;let e=null,t=(0<=l&&ne(null,e=0<r?re(o,n[f-l],te(o)[2]-.5*i,v+"%",i,"end"):re(o,n[l],v+"%",.9*i,i),{"dominant-baseline":"central",class:"cg_"+_}),[v,0]);0<r&&(t=[t[1],t[0]]),ne(ze,"use",{href:"#mg"+r+"_"+_,x:t[0],y:t[1],class:"cg_"+_})}}}function Je(e,t,l){var t=e/t,n=b(c(t));const r=d(t/10**n);var i=u.findIndex(function(e){return e>=r}),t=u[i]*10**n;return l&&1<=e&&t<1?1:t}function Qe(e,t,l,n,r){let i=[t,0,0,n,t,100];0<l&&(i=[i[1],i[0],i[3],i[2],i[5],i[4]]),fe&&ie(e,i[0],i[1],i[4],i[5],"rgb(223,223,223)",r);n=ie(e,0,0,i[2],i[3]),t=ie(e,-i[2],-i[3],0,0);le(n,[i[0],i[1]],[1,1]),le(t,[i[4],i[5]],[1,1]),ne(null,n,{class:"marker_"+_}),ne(null,t,{class:"marker_"+_})}function $e(t,l,e){var n=b((e-t)/l*(1+1e-12))+1;out=Array(n);for(let e=0;e<n;++e)out[e]=t+l*e;return out}function et(l){var n=["y","z","a","f","p","n","u","m","","k","M","G","T","P","E","Z","Y"],r=Array(l.length);for(let t=0;t<l.length;++t){var i=l[t].toExponential(5).split(/e/);let e=b(+i[1]/3)+8;e>n.length-1?e=n.length-1:e<0&&(e=0),r[t]=a(i[0]*10**(+i[1]-3*(e-8))*1e3)/1e3+n[e]}return r}function Q(e){return f.getElementById(e)}function $(e,t,l){e.setAttribute(t,l)}function ee(e,t){return e.getAttribute(t)}function te(e){return[e.x.baseVal.value,e.y.baseVal.value,e.width.baseVal.value,e.height.baseVal.value]}function tt(e){return[e.viewBox.baseVal.x,e.viewBox.baseVal.y,e.viewBox.baseVal.width,e.viewBox.baseVal.height]}function le(e,t,l){t=null!=t?"translate("+t[0]+" "+t[1]+")":"";t+=null!=l?"scale("+l[0]+" "+l[1]+")":"",e.setAttribute("transform",t)}function ne(e,t,l){var n,r="string"==typeof t?f.createElementNS(y,t):t;for(n in l)$(r,n,l[n]);return null!=e&&e.appendChild(r),r}function re(e,t,l,n,r,i="middle",o="Sans,Arial",s="black"){e=ne(e,"text",{x:l,y:n,fill:s,"font-size":r,"text-anchor":i,"font-family":o,"stroke-width":1});return e.append(f.createTextNode(t)),e}function ie(e,t,l,n,r,i="black",o="",s=1){return ne(e,"line",{x1:t,y1:l,x2:n,y2:r,stroke:i,"stroke-width":s,"stroke-dasharray":o,"vector-effect":"non-scaling-stroke"})}function oe(e,t,l,n,r,i="none",o="none",s=2,a=0){return ne(e,"rect",{x:t,y:l,width:n,height:r,rx:a,stroke:o,"stroke-width":s,fill:i,"vector-effect":"non-scaling-stroke"})}le(Z,[M[2]-18,M[1]-24]),ne(Z,"polyline",{stroke:"black",fill:"none",points:"8,0 8,16 2,9 8,16 14,9"}),ne(Z,"polyline",{stroke:"black",fill:"none",points:"0,17 0,20 16,20 16,17"}),oe(Z,0,0,21,21),Z.onclick=()=>{var e,t;Z.style.display="none",P.style.cursor="auto",e='<svg width="'+(e=te(R))[2]+'" height="'+e[3]+'" xmlns="'+y+'">',e=new Blob([e,R.innerHTML,"</svg>"],{type:"image/svg+xml;charset=utf-8"}),e=URL.createObjectURL(e),(t=f.createElement("a")).href=e,t.download="snapshot_"+se+".svg",ne(f.body,t),t.click(),f.body.removeChild(t),Z.style.display="block",P.style.cursor="crosshair"},S.onclick=t=>{var l=te(P),n=(a=tt(P))[2]/l[2],r=a[3]/l[3],s=(t.offsetX-l[0])*n+a[0],s=(result=function(t,l,n,r,i,o){let s=null,a=e,c=0,h=0;var g=Q("gp_"+t),u=g.children.length;for(let e=0;e<u;++e){var f=g.children[e],d=f.points;if("none"!=f.style.display)for(let e=1;e<d.length;++e){var y,v,x,p,m,b,w=d[e-1],k=d[e];l<w.x-r&&l<k.x-r||l>w.x+r&&l>k.x+r||n<w.y-i&&n<k.y-i||n>w.y+i&&n>k.y+i||(y=k.x-w.x,x=(y*(l-w.x)+(v=k.y-w.y)*(n-w.y))/(y*y+v*v),1<=(x=((y=w.x+y*x)-l)*(y-l)/r/r+((v=w.y+v*x)-n)*(v-n)/i/i))||x>a||(a=x,s=f,x=w.x<l?l-w.x:w.x-l,p=w.y<n?n-w.y:w.y-n,m=k.x<l?l-k.x:k.x-l,b=k.y<n?n-k.y:k.y-n,x<m&&x<r&&p<i?(c=w.x,h=w.y):m<r&&b<i?(c=k.x,h=k.y):o&&0!=ee(f,"stroke-width")?(c=y,h=v):s=null)}}return{ele:s,x:c,y:h}}(_,s,t=(t.offsetY-l[1])*r+a[1],a=6*n,c=6*r,ye)).ele;if(null!=s){var t=result.x,a=result.y,c="pl_"+_,s=s.id,c=s.slice(c.length,s.length),s=Q("lti_"+_+c),h=ee(Q("pl_"+_+c),"stroke"),g=function(e,t,l){return B=e[0]/100*t[2]+t[0],A=(1-e[1]/100)*t[3]+t[1],[B=l[0]?10**B:B,A=l[1]?10**A:A]}([t,a],K,C);let e=Q("gpl_"+_+c);null==e&&(e=ne(P,"g",{id:"gpl_"+_+c}));const f=ne(e,"g",{class:"marker_"+_}),d=ne(f,"g");c=oe(d,0,-33,1,33,h,"rgb(223,223,223)",1,rx=4),h=(le(f,[t,a],[n,r]),f.onclick=e=>{e.ctrlKey?u(1):(f.remove(),1<e.detail&&We(K))},null!=s&&(ne(null,text=re(d,s.textContent,2,-35,12,"start","Sans,Arial","white"),{"font-weight":"bold"}),ne(null,c,{y:-48,height:48})),re(d,"x: "+et([g[0]]),2,-19,12,"start","Sans,Arial","white"),re(d,"y: "+et([g[1]]),2,-5,12,"start","Sans,Arial","white"),f.getBBox());const y=[h.width+4,h.height],v=(ne(null,c,{width:y[0]}),null!=s&&ie(d,0,-31,y[0],-31,stroke="white"),ie(f,0,0,6,-6));t=d.getBoundingClientRect();let i=t.right+5+Y.offsetLeft>l[0]+l[2],o=t.y-5-Y.offsetTop<l[1];function u(e){let t=5,l=-5,n=1,r=1;e&&([i,o]=[!o,i]),i&&(t=-y[0]-5,n=-1),o&&(l=y[1]+5,r=-1),le(d,[t,l]),le(v,null,[n,r])}u(!1),oe(f,-2,-2,4,4,"black"),ne(f,"circle",{r:6,fill:"none","pointer-events":"visible"})}},R.oncontextmenu=e=>{e.preventDefault()},P.onmousedown=t=>{{let e=0;if(t.button==h||t.button==g&&t.ctrlKey)e=1;else if(t.button!=g)return;P.style.cursor=e?"move":"zoom-in";const o=t.offsetX,s=t.offsetY,l=oe(R,o,s,0,0,"black"),n=e?0:.3;ne(null,l,{id:"zoom_rect"+_,"fill-opacity":n}),R.onmousemove=e=>{var t=o,l=s,n=Q("zoom_rect"+_),r=e.offsetX,t=r-t,l=(e=e.offsetY)-l,i=0==ee(n,"fill-opacity");i||0<=t?$(n,"width",t):ne(null,n,{width:-t,x:r}),i||0<=l?$(n,"height",l):ne(null,n,{height:-l,y:e})}}},P.ondblclick=()=>We(K),R.onmousedown=e=>{e.preventDefault()},R.onmouseup=()=>{var t=Q("zoom_rect"+_);if(P.style.cursor="crosshair",(R.onmousemove=null)!=t){var l=0==ee(t,"fill-opacity"),n=te(t);if(t.remove(),!~l||0!=n[2]&&0!=n[3]){var t=tt(P),r=te(P);let e=[];e=l?[-n[2]/r[2],n[3]/r[3],1,1]:[(n[0]-r[0])/r[2],1-(n[1]+n[3]-r[1])/r[3],n[2]/r[2],n[3]/r[3]];l=[K[0]+K[2]*t[0]/100,K[1]+K[3]*(100-t[3]-t[1])/100,K[2]*t[2]/100,K[3]*t[3]/100];We([l[0]+e[0]*l[2],l[1]+e[1]*l[3],e[2]*l[2],e[3]*l[3]])}}},0<z.length&&(X.onwheel=e=>{F;var t=te(H),l=tt(H),t=F-t[3];return l[1]+=e.deltaY,l[1]<0&&(l[1]=0),t<l[1]&&(l[1]=t),H.viewBox.baseVal.y=l[1],ke.y.baseVal.value=l[1],!1}),new ResizeObserver(()=>Pe()).observe(R),Pe()}}