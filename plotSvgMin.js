function num2eng(t){var l=["y","z","a","f","p","n","u","m","","k","M","G","T","P","E","Z","Y"],n=Array(t.length);for(idx=0;idx<t.length;++idx){var i=t[idx].toExponential(5).split(/e/);let e=Math.floor(+i[1]/3)+8;e>l.length-1?e=l.length-1:e<0&&(e=0),n[idx]=Math.round(i[0]*Math.pow(10,+i[1]-3*(e-8))*1e3)/1e3+l[e]}return n}function linspace(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=val;return out}function logspace(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=Math.log10(val);return out}function decades(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=Math.pow(10,val);return out}function createSVGElement(e,t){var l,n=document.createElementNS("http://www.w3.org/2000/svg",e);for(l in t)n.setAttribute(l,t[l]);return n}function appendSvgText(e,t,l,n,i,a="middle",o="Sans,Arial",d="black"){l=createSVGElement("text",{x:l,y:n,fill:d,"font-size":i,"text-anchor":a,"font-family":o,"stroke-width":1});return l.append(document.createTextNode(t)),e.appendChild(l),l}function appendSvgLine(e,t,l,n,i,a="black",o=""){t=createSVGElement("line",{x1:t,y1:l,x2:n,y2:i,stroke:a,"stroke-width":1,"stroke-dasharray":o,"vector-effect":"non-scaling-stroke"});return e.appendChild(t),t}function toggleLineVisibility(e,t,l,n){var i=document.getElementById("pl_"+e+"_"+t).style.display;if(0==n){var a=document.getElementById("gpl_"+e+"_"+t);"none"===i?(document.getElementById("pl_"+e+"_"+t).style.display="block",document.getElementById("lli_"+e+"_"+t).style.opacity=1,document.getElementById("lti_"+e+"_"+t).style.opacity=1,null!=a&&(a.style.display="block")):(document.getElementById("pl_"+e+"_"+t).style.display="none",document.getElementById("lli_"+e+"_"+t).style.opacity=.3,document.getElementById("lti_"+e+"_"+t).style.opacity=.3,null!=a&&(a.style.display="none"))}else for(idx=0;idx<n;++idx){var o=document.getElementById("gpl_"+e+"_"+idx);"none"===i?(document.getElementById("pl_"+e+"_"+idx).style.display="block",document.getElementById("lli_"+e+"_"+idx).style.opacity=1,document.getElementById("lti_"+e+"_"+idx).style.opacity=1,null!=o&&(o.style.display="block")):idx!=t&&(document.getElementById("pl_"+e+"_"+idx).style.display="none",document.getElementById("lli_"+e+"_"+idx).style.opacity=.3,document.getElementById("lti_"+e+"_"+idx).style.opacity=.3,null!=o)&&(o.style.display="none")}}function removeInvalidPoints(e){var t=e[0],l=e[1],n=Array(t.length),i=Array(l.length);if(t.length==l.length){var a=0;for(idx=0;idx<l.length;++idx)isFinite(t[idx])&&isFinite(l[idx])&&(n[a]=t[idx],i[a]=l[idx],++a);a<t.length&&(n=n.slice(0,a),i=i.slice(0,a))}else{var a=0,o=l.length/t.length,d=t.length;for(idx=0;idx<d;++idx){var r=isFinite(t[idx]),s=!0;for(idxLines=0;idxLines<o;++idxLines){if(!isFinite(l[idxLines*d+idx])){s=!1;break}i[idxLines*d+a]=l[idxLines*d+idx]}r&&s&&(n[a]=t[idx],++a)}if(a<t.length){for(n=n.slice(0,a),idx=a=0;idx<l.length;++idx)idx%d<n.length&&(i[a]=l[idx],++a);i=i.slice(0,n.length*o)}}return[n,i]}function resizeSvg(e,t,l,n,i){var a=document.getElementById("svg_leg_"+e),o=document.getElementById("svg_draw_"+e),e=document.getElementById("svg_"+e),d=e.width.baseVal.value-t,r=e.height.baseVal.value-l,s=o.width.baseVal.value,g=o.height.baseVal.value;if(tooltips=document.getElementsByClassName("tooltip"),s!=d)for(o.width.baseVal.value=d,idx=0;idx<tooltips.length;++idx){var c=o.x.baseVal.value,p=tooltips[idx].transform.baseVal[0].matrix.e;tooltips[idx].transform.baseVal[0].matrix.e=c+(p-c)*d/s}if(g!=r)for(o.height.baseVal.value=r,null!=a&&(a.height.baseVal.value=t=n<(t=r-i)?n:t,a.viewBox.baseVal.height=t),idx=0;idx<tooltips.length;++idx){var h=o.y.baseVal.value,x=tooltips[idx].transform.baseVal[0].matrix.f;tooltips[idx].transform.baseVal[0].matrix.f=h+(x-h)*r/g}}function scrollLegend(e,t,l){var n=document.getElementById("svg_leg_"+t),t=document.getElementById("rect_leg_"+t),e=(n.viewBox.baseVal.y+=e.deltaY,l-n.height.baseVal.value);return n.viewBox.baseVal.y<0&&(n.viewBox.baseVal.y=0),n.viewBox.baseVal.y>e&&(n.viewBox.baseVal.y=e),t.y.baseVal.value=n.viewBox.baseVal.y,!1}function plotClicked(e,t,l,n,i,a,o,d,r,s){if(svgDraw=document.getElementById("svg_draw_"+t),svg=document.getElementById("svg_"+t),null!=(closestEl=getNearestLine(e.clientX,e.clientY))){var g=e.offsetX-svgDraw.x.baseVal.value,c=e.offsetY-svgDraw.y.baseVal.value,e=l/svgDraw.width.baseVal.value,p=n/svgDraw.height.baseVal.value,h=(g*=e,c*=p,closestEl.points),x=0,m=1/0;for(idx=0;idx<h.length;++idx){var u=h[idx].x,v=h[idx].y,u=(u-g)*(u-g)+(v-c)*(v-c);u<m&&(m=u,x=idx)}var y=h[x].x>g?x-1:x+1,f=(y=h.length<=(y=y<0?0:y)?h.length-1:y,(h[x].x-g)/(h[x].x-h[y=m<36?x:y].x)),b=h[y].x*(f=y==x?1:f)+h[x].x*(1-f),y=h[y].y*f+h[x].y*(1-f),f=b/e+svgDraw.x.baseVal.value,e=y/p+svgDraw.y.baseVal.value,p=closestEl.id,p=p.slice(("pl_"+t).length,p.length),w=document.getElementById("lti_"+t+p),k=document.getElementById("lli_"+t+p),k=(lineColor=k.getAttribute("stroke"),sourceCoord=convertCoord([b,y],l,n,[i,a],[o,d],r,s),document.getElementById("gpl_"+t+p)),b=(null==k&&(k=createSVGElement("g",{id:"gpl_"+t+p}),svg.append(k)),createSVGElement("g",{class:"tooltip",transform:"translate("+f+" "+e+")"})),y=(b.onclick=e=>{"g"==e.srcElement.parentNode.tagName&&e.srcElement.parentNode.remove()},createSVGElement("rect",{x:5,y:-21,stroke:"rgb(223,223,223)",fill:lineColor,rx:4,"vector-effect":"non-scaling-stroke"})),l=(b.append(y),null!=w&&((text=appendSvgText(b,w.textContent,7,-9,12,"start","Sans,Arial","white")).setAttribute("font-weight","bold"),line=appendSvgLine(b,5,-6,5,-6,stroke="white")),appendSvgText(b,"x: "+num2eng([sourceCoord[0]]),7,6,12,"start","Sans,Arial","white"),appendSvgText(b,"y: "+num2eng([sourceCoord[1]]),7,20,12,"start","Sans,Arial","white"),k.append(b),b.getBBox()),n=(y.setAttribute("width",l.width+4),y.setAttribute("height",l.height+4),null!=line&&line.setAttribute("x2",l.width+4+5),createSVGElement("rect",{x:-2,y:-2,width:4,height:4,fill:"black"}));b.append(n)}}function convertCoord(e,t,l,n,i,a,o){return x=e[0]/t*(n[1]-n[0])+n[0],y=(1-e[1]/l)*(i[1]-i[0])+i[0],x=a?Math.pow(10,x):x,y=o?Math.pow(10,y):y,[x,y]}function getNearestLine(l,n){var i=null,a=1/0;for(let t=l-4;t<=l+4;t++)for(let e=n-4;e<=n+4;e++){var o,d=document.elementFromPoint(t,e);"polyline"==d?.tagName&&(o=(t-l)*(t-l)+(e-n)*(e-n))<a&&(a=o,i=d)}return i}function plotSvg(t,e,l,n,{title:i="",subtitle:a="",xlabel:o="",ylabel:d="",xlim:r=[],ylim:s=[],legend:P=[],xScale:g="linear",yScale:c="linear",grid:Y=!0,gridMinor:p=[],legendLocation:h="northeast"}={}){var X="http://www.w3.org/2000/svg",x=10,m=10,u=[1,2,5,10],D=["rgb(0,114,190)","rgb(218,83,25)","rgb(238,178,32)","rgb(126,47,142)","rgb(119,173,48)","rgb(77,191,239)","rgb(163,20,47)"],v=(logXEnbl=!1,"log"==g&&(e=e.map(Math.log10),1<r.length&&(r=r.map(Math.log10),isNaN(r[0])||isNaN(r[1])?r=[]:(r[0]=r[0]==-1/0?0:r[0],r[1]=r[1]==-1/0?0:r[1])),logXEnbl=!0),logYEnbl=!1,"log"==c&&(l=l.map(Math.log10),1<s.length&&(s=s.map(Math.log10),isNaN(s[0])||isNaN(s[1])?s=[]:(s[0]=s[0]==-1/0?0:s[0],s[1]=s[1]==-1/0?0:s[1])),logYEnbl=!0),e=(newPts=removeInvalidPoints([e,l]))[0],l=newPts[1],document.getElementById(t)),y=document.createElement("div"),v=(v.appendChild(y),y.setAttribute("style","width:100%;height:calc(100vh - 16px);overflow:none"),createSVGElement("svg",{id:"svg_"+t,width:"100%",height:"100%"})),y=(y.appendChild(v),v.width.baseVal.value),f=v.height.baseVal.value,b=y/4,w=(v.innerHTML+="<style>\n<![CDATA[\n  polyline.l {\n    stroke-width:2;\n    vector-effect:non-scaling-stroke;\n    fill:none;\n  }\n  text.cll {\n    font-size:10px;\n    fill:black;\n    dominant-baseline:middle;\n    font-family:Lucida Sans Typewriter;\n  }\n]]>\n</style>\n",0),k=60,O=i.split("\n"),z=a.split("\n"),E=(0<i.length&&(w+=28*O.length),0<a.length&&(w+=16*z.length),f-(w+=10)-36),A=y-k,F=(0<o.length&&(E=E-12-4),0<d.length&&(k=k+12+4,A=A-12-4),createSVGElement("g")),U=0;if(0<P.length&&0<n&&0<e.length){var R="";switch(h){case"northeast":yLegend=w+8,U=16,R="white";break;case"northeastoutside":yLegend=w,R="none";break;default:throw new Error("LegendLocation not supported")}hLegendMax=E-U,v.appendChild(F);var j=createSVGElement("defs"),_=(v.appendChild(j),createSVGElement("line",{id:"ll_"+t,x1:0,y1:0,x2:20,y2:0,"stroke-width":2,"vector-effect":"non-scaling-stroke"})),I=(j.appendChild(_),wLegendMax=b,hLetter=10,createSVGElement("svg",{id:"svg_leg_"+t})),S=n,H=P,Z=(P.length>n&&(H=P.slice(0,S)),S*(hLetter+4)+4),j=Z>hLegendMax?hLegendMax:Z,_=(I.setAttribute("x","100%"),I.setAttribute("height",j),F.appendChild(I),createSVGElement("rect",{id:"rect_leg_"+t,x:0,y:0,height:"100%",fill:R,stroke:"black","stroke-width":2,"vector-effect":"non-scaling-stroke"}));for(I.appendChild(_),lineIdx=0;lineIdx<S;++lineIdx){colorIdx=lineIdx%D.length,yOffset=lineIdx*(hLetter+4)+4;var q=createSVGElement("use",{id:"lli_"+t+"_"+lineIdx,x:4,y:yOffset+hLetter/2,href:"#ll_"+t,stroke:D[colorIdx],onclick:'toggleLineVisibility("'+t+'","'+lineIdx+'", 0, 0)',ondblclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",'+S+","+n+")"}),J=(I.appendChild(q),createSVGElement("text",{id:"lti_"+t+"_"+lineIdx,class:"cll",x:28,y:yOffset+hLetter/2,onclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",0, 0)',ondblclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",'+S+","+n+")"}));lineIdx<H.length?J.append(document.createTextNode(H[lineIdx])):J.append(document.createTextNode("")),I.appendChild(J)}var V=(V=F.getBBox().width+8)>wLegendMax?wLegendMax:V;for(_.setAttribute("width","100%"),I.setAttribute("width",V),lineIdx=0;lineIdx<S;++lineIdx){colorIdx=lineIdx%D.length,yOffset=lineIdx*(hLetter+4)+4;var K=createSVGElement("rect",{id:"lri_"+t+"_"+lineIdx,x:4,y:yOffset,width:V,height:hLetter+4,fill:"none","pointer-events":"visible",onclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",0,0)',ondblclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",'+S+","+n+")"});I.appendChild(K)}var Q=0;switch(h){case"northeast":Q=-V-8-60,A-=60;break;case"northeastoutside":Q=-V,A-=V+4;break;default:throw new Error("LegendLocation not supported")}I.setAttribute("x","calc(100% + "+Q+"px)"),I.setAttribute("y",yLegend),I.setAttribute("viewBox","0 0 "+V+" "+j)}else A-=42;var L=[y-(plotArea=[k,w,A,E])[2],f-plotArea[3]],W=createSVGElement("svg",{x:plotArea[0],overflow:"visible",width:"calc(100% - "+L[0]+"px)"}),$=(v.appendChild(W),0);if(0<i.length)for(idx=0;idx<O.length;++idx)$=$+24+4,appendSvgText(W,O[idx],"50%",$,24);if(0<a.length)for(idx=0;idx<z.length;++idx)$=$+12+4,appendSvgText(W,z[idx],"50%",$,12);var b=-f+plotArea[1]+plotArea[3],_=createSVGElement("g",{transform:"translate("+plotArea[0]+" "+b+")"}),ee=createSVGElement("svg",{overflow:"visible",y:"100%",width:"calc(100% - "+L[0]+"px)"}),te=(_.appendChild(ee),v.appendChild(_),0<o.length&&appendSvgText(ee,o,"50%",36,12),createSVGElement("svg",{y:plotArea[1],overflow:"visible",height:"calc(100% - "+L[1]+"px)"})),T=(v.appendChild(te),0<d.length&&((h=createSVGElement("text",{"writing-mode":"sideways-lr",fill:"black","font-size":12,"text-anchor":"middle","font-family":"Sans,Arial","stroke-width":1,y:"50%",x:plotArea[0]-48-4})).append(document.createTextNode(d)),te.appendChild(h)),0),M=0,C=0,B=0,j=(r.length<2?(T=Math.min(...e),M=Math.max(...e),NaN==T&&(T=0,M=1),T==M&&(T-=.5,M+=.5)):(T=r[0],M=r[1]),s.length<2?(C=Math.min(...l),B=Math.max(...l),NaN==C&&(C=0,B=1),C==B&&(C-=.5,B+=.5)):(C=s[0],B=s[1]),v.width.baseVal.value-L[0]),y=v.height.baseVal.value-L[1],G=createSVGElement("svg",{id:"svg_draw_"+t,preserveAspectRatio:"none",viewBox:"0 0 "+plotArea[2]+" "+plotArea[3],width:j,height:y,x:plotArea[0],y:plotArea[1]}),k=!1,E=!1,E=p.length<1?(k="log"==g,"log"==c):(k=p[0],p[1]),i=(M-T)/10,a=Math.floor(Math.log10(i)),le=Math.ceil(i/Math.pow(10,a)),f=u.findIndex(function(e){return le<=e}),i=u[f]*Math.pow(10,a),b=(logXEnbl?1<=M-T?1<(i=i<1?1:i)&&(x=x<i?x:i):x=0:x=5,(B-C)/10),a=Math.floor(Math.log10(b)),le=Math.ceil(b/Math.pow(10,a)),f=u.findIndex(function(e){return le<=e}),b=u[f]*Math.pow(10,a),_=(logYEnbl?1<=B-C?1<(b=b<1?1:b)&&(m=m<b?m:b):m=0:m=5,r.length<1&&4<=(M-T)/i&&(T=Math.floor(T/i)*i,M=Math.ceil(M/i)*i),s.length<1&&4<=(B-C)/b&&(C=Math.floor(C/b)*b,B=Math.ceil(B/b)*b),Math.ceil(T/i)*i),o=Math.floor(M/i)*i,d=Math.ceil(C/b)*b,h=Math.floor(B/b)*b,j=plotArea[2]*(_-T)/(M-T),y=plotArea[3]*(h-B)/(B-C),ne=100*(_-T)/(M-T),ie=100*(h-B)/(B-C),ae=Math.round((o-_)/i),oe=Math.round((h-d)/b),g=plotArea[2]>plotArea[3]?plotArea[2]/100:plotArea[3]/100,c=g/2;for(xTickLabel=logXEnbl?num2eng(decades(_,i,o)):num2eng(linspace(_,i,o)),yTickLabel=logYEnbl?num2eng(decades(d,b,h)):num2eng(linspace(d,b,h)),dXTick=plotArea[2]*i/(M-T),dXTickPct=100*i/(M-T),dYTick=plotArea[3]*b/(B-C),dYTickPct=100*b/(B-C),idx=0;idx<=oe;++idx){var de=-ie+dYTickPct*idx;(J=appendSvgText(te,yTickLabel[oe-idx],plotArea[0]-6,de+"%",12,"end")).setAttribute("alignment-baseline","middle")}for(idx=0;idx<=ae;++idx){var re=dXTickPct*idx+ne;appendSvgText(ee,xTickLabel[idx],re+"%",12*1.4,12)}var p=document.createElementNS(X,"defs"),se=(G.appendChild(p),E&&0<m&&(u=createSVGElement("g",{id:"mgy_"+t}),Y&&appendSvgLine(u,0,1,plotArea[2],1,stroke="rgb(223,223,223)",strokedasharray="2 4"),appendSvgLine(u,0,1,c,1),appendSvgLine(u,plotArea[2]-c,1,plotArea[2],1),p.appendChild(u)),createSVGElement("pattern",{id:"yTick_"+t,x:0,y:y-1,width:plotArea[2],height:dYTick,patternUnits:"userSpaceOnUse"}));if(p.appendChild(se),E&&0<m)for(logYEnbl&&1==b?(minorTickPos=logspace(1,9/(m-1),10)).forEach((e,t)=>{minorTickPos[t]=(1-minorTickPos[t])*dYTick}):minorTickPos=linspace(0,1/m*dYTick,dYTick),idx=1;idx<minorTickPos.length-1;++idx){var ge=createSVGElement("use",{href:"#mgy_"+t,y:minorTickPos[idx]});se.append(ge)}Y&&appendSvgLine(se,0,1,plotArea[2],1,stroke="rgb(223,223,223)"),appendSvgLine(se,0,1,g,1),appendSvgLine(se,plotArea[2]-g,1,plotArea[2],1);var f=createSVGElement("rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"url(#yTick_"+t+")"}),a=(G.appendChild(f),document.createElementNS(X,"defs")),ce=(G.appendChild(a),k&&0<x&&(r=createSVGElement("g",{id:"mgx_"+t}),Y&&appendSvgLine(r,1,0,1,plotArea[3],stroke="rgb(223,223,223)",strokedasharray="2 4"),appendSvgLine(r,1,0,1,c),appendSvgLine(r,1,plotArea[3]-c,1,plotArea[3]),a.appendChild(r)),createSVGElement("pattern",{id:"xTick_"+t,x:j-1,y:0,width:dXTick,height:plotArea[3],patternUnits:"userSpaceOnUse"}));if(a.appendChild(ce),k&&0<x)for(logXEnbl&&1==i?(minorTickPos=logspace(1,9/(x-1),10)).forEach((e,t)=>{minorTickPos[t]*=dXTick}):minorTickPos=linspace(0,1/x*dXTick,dXTick),idx=1;idx<minorTickPos.length-1;++idx){var pe=createSVGElement("use",{href:"#mgx_"+t,x:minorTickPos[idx],"vector-effect":"non-scaling-stroke"});ce.append(pe)}Y&&appendSvgLine(ce,1,0,1,plotArea[3],stroke="rgb(223,223,223)"),appendSvgLine(ce,1,0,1,g),appendSvgLine(ce,1,plotArea[3]-g,1,plotArea[3]);var s=createSVGElement("rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"url(#xTick_"+t+")"}),he=(G.appendChild(s),l.length/n),xe=e.length==l.length;if(!xe&&he!=e.length)throw new Error("Dimension must agree");for(lineIdx=0;lineIdx<n;++lineIdx){var N=e.length,me=new Array(2*N);for(colorIdx=lineIdx%D.length,ptIdx=0;ptIdx<he;++ptIdx){var ue=xe?e[lineIdx*he+ptIdx]:e[ptIdx],ve=l[lineIdx*he+ptIdx];me[2*ptIdx]=plotArea[2]*(ue-T)/(M-T),me[2*ptIdx+1]=plotArea[3]-plotArea[3]*(ve-C)/(B-C)}N=document.createElementNS(X,"polyline");N.setAttribute("class","l"),N.setAttribute("id","pl_"+t+"_"+lineIdx),N.setAttribute("points",me.join(" ")),N.setAttribute("stroke",D[colorIdx]),G.appendChild(N)}_=createSVGElement("rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"none",stroke:"black","stroke-width":2,"vector-effect":"non-scaling-stroke"});G.appendChild(_),v.appendChild(G),v.appendChild(F),G.onclick=e=>plotClicked(e,t,plotArea[2],plotArea[3],T,M,C,B,logXEnbl,logYEnbl),0<P.length&&(F.onwheel=e=>scrollLegend(e,t,Z)),new ResizeObserver(()=>resizeSvg(t,L[0],L[1],Z,U)).observe(v)}