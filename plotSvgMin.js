function num2eng(t){var l=["y","z","a","f","p","n","u","m","","k","M","G","T","P","E","Z","Y"],i=Array(t.length);for(idx=0;idx<t.length;++idx){var n=t[idx].toExponential(5).split(/e/);let e=Math.floor(+n[1]/3)+8;e>l.length-1?e=l.length-1:e<0&&(e=0),i[idx]=Math.round(n[0]*Math.pow(10,+n[1]-3*(e-8))*1e3)/1e3+l[e]}return i}function linspace(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=val;return out}function logspace(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=Math.log10(val);return out}function decades(e,t,l){for(numel=Math.floor((l-e)/t)+1,out=Array(numel),idx=0,val=e;val<=l;++idx,val+=t)out[idx]=Math.pow(10,val);return out}function createSVGElement(e,t){var l,i=document.createElementNS("http://www.w3.org/2000/svg",e);for(l in t)i.setAttribute(l,t[l]);return i}function appendSvgText(e,t,l,i,n,a="middle",o="Sans,Arial",r="black"){l=createSVGElement("text",{x:l,y:i,fill:r,"font-size":n,"text-anchor":a,"font-family":o,"stroke-width":1});return l.append(document.createTextNode(t)),e.appendChild(l),l}function appendSvgLine(e,t,l,i,n,a="black",o=""){t=createSVGElement("line",{x1:t,y1:l,x2:i,y2:n,stroke:a,"stroke-width":1,"stroke-dasharray":o,"vector-effect":"non-scaling-stroke"});return e.appendChild(t),t}function toggleLineVisibility(e,t,l,i){var n=document.getElementById("pl_"+e+"_"+t).style.display;if(0==i)"none"===n?(document.getElementById("pl_"+e+"_"+t).style.display="block",document.getElementById("lli_"+e+"_"+t).style.opacity=1,document.getElementById("lti_"+e+"_"+t).style.opacity=1):(document.getElementById("pl_"+e+"_"+t).style.display="none",document.getElementById("lli_"+e+"_"+t).style.opacity=.3,document.getElementById("lti_"+e+"_"+t).style.opacity=.3);else for(idx=0;idx<i;++idx)"none"===n?(document.getElementById("pl_"+e+"_"+idx).style.display="block",idx<l&&(document.getElementById("lli_"+e+"_"+idx).style.opacity=1,document.getElementById("lti_"+e+"_"+idx).style.opacity=1)):idx!=t&&(document.getElementById("pl_"+e+"_"+idx).style.display="none",idx<l)&&(document.getElementById("lli_"+e+"_"+idx).style.opacity=.3,document.getElementById("lti_"+e+"_"+idx).style.opacity=.3)}function removeInvalidPoints(e){var t=e[0],l=e[1],i=Array(t.length),n=Array(l.length);if(t.length==l.length){var a=0;for(idx=0;idx<l.length;++idx)isFinite(t[idx])&&isFinite(l[idx])&&(i[a]=t[idx],n[a]=l[idx],++a);a<t.length&&(i=i.slice(0,a),n=n.slice(0,a))}else{var a=0,o=l.length/t.length,r=t.length;for(idx=0;idx<r;++idx){var d=isFinite(t[idx]),s=!0;for(idxLines=0;idxLines<o;++idxLines){if(!isFinite(l[idxLines*r+idx])){s=!1;break}n[idxLines*r+a]=l[idxLines*r+idx]}d&&s&&(i[a]=t[idx],++a)}if(a<t.length){for(i=i.slice(0,a),idx=a=0;idx<l.length;++idx)idx%r<i.length&&(n[a]=l[idx],++a);n=n.slice(0,i.length*o)}}return[i,n]}function resizeSvg(e,t,l,i,n){var a=document.getElementById("svg_leg_"+e),o=document.getElementById("svg_draw_"+e),e=document.getElementById("svg_"+e),r=e.width.baseVal.value-t,d=e.height.baseVal.value-l,s=o.width.baseVal.value,g=o.height.baseVal.value;if(tooltips=document.getElementsByClassName("tooltip"),s!=r)for(o.width.baseVal.value=r,idx=0;idx<tooltips.length;++idx){var c=o.x.baseVal.value,p=tooltips[idx].transform.baseVal[0].matrix.e;tooltips[idx].transform.baseVal[0].matrix.e=c+(p-c)*r/s}if(g!=d)for(o.height.baseVal.value=d,null!=a&&(a.height.baseVal.value=t=i<(t=d-n)?i:t,a.viewBox.baseVal.height=t),idx=0;idx<tooltips.length;++idx){var h=o.y.baseVal.value,x=tooltips[idx].transform.baseVal[0].matrix.f;tooltips[idx].transform.baseVal[0].matrix.f=h+(x-h)*d/g}}function scrollLegend(e,t,l){var i=document.getElementById("svg_leg_"+t),t=document.getElementById("rect_leg_"+t),e=(i.viewBox.baseVal.y+=e.deltaY,l-i.height.baseVal.value);return i.viewBox.baseVal.y<0&&(i.viewBox.baseVal.y=0),i.viewBox.baseVal.y>e&&(i.viewBox.baseVal.y=e),t.y.baseVal.value=i.viewBox.baseVal.y,!1}function plotClicked(e,t,l,i,n,a,o,r,d,s){if(svgDraw=document.getElementById("svg_draw_"+t),svg=document.getElementById("svg_"+t),null!=(closestEl=getNearestLine(e.clientX,e.clientY))){var g=e.offsetX-svgDraw.x.baseVal.value,c=e.offsetY-svgDraw.y.baseVal.value,e=l/svgDraw.width.baseVal.value,p=i/svgDraw.height.baseVal.value,h=(g*=e,c*=p,closestEl.points),x=0,m=1/0;for(idx=0;idx<h.length;++idx){var v=h[idx].x,u=h[idx].y,v=(v-g)*(v-g)+(u-c)*(u-c);v<m&&(m=v,x=idx)}var f=h[x].x>g?x-1:x+1,y=(f=h.length<=(f=f<0?0:f)?h.length-1:f,(h[x].x-g)/(h[x].x-h[f=m<36?x:f].x)),b=h[f].x*(y=f==x?1:y)+h[x].x*(1-y),f=h[f].y*y+h[x].y*(1-y),y=b/e+svgDraw.x.baseVal.value,e=f/p+svgDraw.y.baseVal.value,p=closestEl.id,p=p.slice(("pl_"+t).length,p.length),w=document.getElementById("lti_"+t+p),t=document.getElementById("lli_"+t+p),p=(lineColor=t.getAttribute("stroke"),sourceCoord=convertCoord([b,f],l,i,[n,a],[o,r],d,s),createSVGElement("g",{class:"tooltip",transform:"translate("+y+" "+e+")"})),t=(p.onclick=e=>{"g"==e.srcElement.parentNode.tagName&&e.srcElement.parentNode.remove()},createSVGElement("rect",{x:5,y:-21,stroke:"rgb(223,223,223)",fill:lineColor,rx:4,"vector-effect":"non-scaling-stroke"})),b=(p.append(t),null!=w&&((text=appendSvgText(p,w.textContent,7,-9,12,"start","Sans,Arial","white")).setAttribute("font-weight","bold"),line=appendSvgLine(p,5,-6,5,-6,stroke="white")),appendSvgText(p,"x: "+num2eng([sourceCoord[0]]),7,6,12,"start","Sans,Arial","white"),appendSvgText(p,"y: "+num2eng([sourceCoord[1]]),7,20,12,"start","Sans,Arial","white"),svg.append(p),p.getBBox()),f=(t.setAttribute("width",b.width+4),t.setAttribute("height",b.height+4),null!=line&&line.setAttribute("x2",b.width+4+5),createSVGElement("rect",{x:-2,y:-2,width:4,height:4,fill:"black"}));p.append(f)}}function convertCoord(e,t,l,i,n,a,o){return x=e[0]/t*(i[1]-i[0])+i[0],y=(1-e[1]/l)*(n[1]-n[0])+n[0],x=a?Math.pow(10,x):x,y=o?Math.pow(10,y):y,[x,y]}function getNearestLine(l,i){var n=null,a=1/0;for(let t=l-4;t<=l+4;t++)for(let e=i-4;e<=i+4;e++){var o,r=document.elementFromPoint(t,e);"polyline"==r?.tagName&&(o=(t-l)*(t-l)+(e-i)*(e-i))<a&&(a=o,n=r)}return n}function plotSvg(t,e,l,i,{title:n="",subtitle:a="",xlabel:o="",ylabel:r="",xlim:d=[],ylim:s=[],legend:P=[],xScale:g="linear",yScale:c="linear",grid:Y=!0,gridMinor:p=[],legendLocation:h="northeast"}={}){var X="http://www.w3.org/2000/svg",x=10,m=10,v=[1,2,5,10],D=["rgb(0,114,190)","rgb(218,83,25)","rgb(238,178,32)","rgb(126,47,142)","rgb(119,173,48)","rgb(77,191,239)","rgb(163,20,47)"],u=(logXEnbl=!1,"log"==g&&(e=e.map(Math.log10),1<d.length&&(d=d.map(Math.log10),isNaN(d[0])||isNaN(d[1])?d=[]:(d[0]=d[0]==-1/0?0:d[0],d[1]=d[1]==-1/0?0:d[1])),logXEnbl=!0),logYEnbl=!1,"log"==c&&(l=l.map(Math.log10),1<s.length&&(s=s.map(Math.log10),isNaN(s[0])||isNaN(s[1])?s=[]:(s[0]=s[0]==-1/0?0:s[0],s[1]=s[1]==-1/0?0:s[1])),logYEnbl=!0),e=(newPts=removeInvalidPoints([e,l]))[0],l=newPts[1],document.getElementById(t)),f=document.createElement("div"),u=(u.appendChild(f),f.setAttribute("style","width:100%;height:calc(100vh - 16px);overflow:none"),createSVGElement("svg",{id:"svg_"+t,width:"100%",height:"100%"})),f=(f.appendChild(u),u.width.baseVal.value),y=u.height.baseVal.value,b=f/4,w=(u.innerHTML+="<style>\n<![CDATA[\n  polyline.l {\n    stroke-width:2;\n    vector-effect:non-scaling-stroke;\n    fill:none;\n  }\n  text.cll {\n    font-size:10px;\n    fill:black;\n    dominant-baseline:middle;\n    font-family:Lucida Sans Typewriter;\n  }\n]]>\n</style>\n",0),k=60,O=n.split("\n"),z=a.split("\n"),E=(0<n.length&&(w+=28*O.length),0<a.length&&(w+=16*z.length),y-(w+=10)-36),A=f-k,F=(0<o.length&&(E=E-12-4),0<r.length&&(k=k+12+4,A=A-12-4),createSVGElement("g")),U=0;if(0<P.length&&0<i&&0<e.length){var R="";switch(h){case"northeast":yLegend=w+8,U=16,R="white";break;case"northeastoutside":yLegend=w,R="none";break;default:throw new Error("LegendLocation not supported")}hLegendMax=E-U,u.appendChild(F);var j=createSVGElement("defs"),S=(u.appendChild(j),createSVGElement("line",{id:"ll_"+t,x1:0,y1:0,x2:20,y2:0,"stroke-width":2,"vector-effect":"non-scaling-stroke"})),V=(j.appendChild(S),wLegendMax=b,hLetter=10,createSVGElement("svg",{id:"svg_leg_"+t})),I=i,H=P,Z=(P.length>i&&(H=P.slice(0,I)),I*(hLetter+4)+4),j=Z>hLegendMax?hLegendMax:Z,S=(V.setAttribute("x","100%"),V.setAttribute("height",j),F.appendChild(V),createSVGElement("rect",{id:"rect_leg_"+t,x:0,y:0,height:"100%",fill:R,stroke:"black","stroke-width":2,"vector-effect":"non-scaling-stroke"}));for(V.appendChild(S),lineIdx=0;lineIdx<I;++lineIdx){colorIdx=lineIdx%D.length,yOffset=lineIdx*(hLetter+4)+4;var q=createSVGElement("use",{id:"lli_"+t+"_"+lineIdx,x:4,y:yOffset+hLetter/2,href:"#ll_"+t,stroke:D[colorIdx],onclick:'toggleLineVisibility("'+t+'","'+lineIdx+'", 0, 0)',ondblclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",'+I+","+i+")"}),J=(V.appendChild(q),createSVGElement("text",{id:"lti_"+t+"_"+lineIdx,class:"cll",x:28,y:yOffset+hLetter/2,onclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",0, 0)',ondblclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",'+I+","+i+")"}));lineIdx<H.length?J.append(document.createTextNode(H[lineIdx])):J.append(document.createTextNode("")),V.appendChild(J)}var _=(_=F.getBBox().width+8)>wLegendMax?wLegendMax:_;for(S.setAttribute("width","100%"),V.setAttribute("width",_),lineIdx=0;lineIdx<I;++lineIdx){colorIdx=lineIdx%D.length,yOffset=lineIdx*(hLetter+4)+4;var K=createSVGElement("rect",{id:"lri_"+t+"_"+lineIdx,x:4,y:yOffset,width:_,height:hLetter+4,fill:"none","pointer-events":"visible",onclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",0,0)',ondblclick:'toggleLineVisibility("'+t+'","'+lineIdx+'",'+I+","+i+")"});V.appendChild(K)}var Q=0;switch(h){case"northeast":Q=-_-8-60,A-=60;break;case"northeastoutside":Q=-_,A-=_+4;break;default:throw new Error("LegendLocation not supported")}V.setAttribute("x","calc(100% + "+Q+"px)"),V.setAttribute("y",yLegend),V.setAttribute("viewBox","0 0 "+_+" "+j)}else A-=42;var L=[f-(plotArea=[k,w,A,E])[2],y-plotArea[3]],W=createSVGElement("svg",{x:plotArea[0],overflow:"visible",width:"calc(100% - "+L[0]+"px)"}),$=(u.appendChild(W),0);if(0<n.length)for(idx=0;idx<O.length;++idx)$=$+24+4,appendSvgText(W,O[idx],"50%",$,24);if(0<a.length)for(idx=0;idx<z.length;++idx)$=$+12+4,appendSvgText(W,z[idx],"50%",$,12);var b=-y+plotArea[1]+plotArea[3],S=createSVGElement("g",{transform:"translate("+plotArea[0]+" "+b+")"}),ee=createSVGElement("svg",{overflow:"visible",y:"100%",width:"calc(100% - "+L[0]+"px)"}),te=(S.appendChild(ee),u.appendChild(S),0<o.length&&appendSvgText(ee,o,"50%",36,12),createSVGElement("svg",{y:plotArea[1],overflow:"visible",height:"calc(100% - "+L[1]+"px)"})),T=(u.appendChild(te),0<r.length&&((h=createSVGElement("text",{"writing-mode":"sideways-lr",fill:"black","font-size":12,"text-anchor":"middle","font-family":"Sans,Arial","stroke-width":1,y:"50%",x:plotArea[0]-48-4})).append(document.createTextNode(r)),te.appendChild(h)),0),M=0,C=0,B=0,j=(d.length<2?(T=Math.min(...e),M=Math.max(...e),NaN==T&&(T=0,M=1),T==M&&(T-=.5,M+=.5)):(T=d[0],M=d[1]),s.length<2?(C=Math.min(...l),B=Math.max(...l),NaN==C&&(C=0,B=1),C==B&&(C-=.5,B+=.5)):(C=s[0],B=s[1]),u.width.baseVal.value-L[0]),f=u.height.baseVal.value-L[1],G=createSVGElement("svg",{id:"svg_draw_"+t,preserveAspectRatio:"none",viewBox:"0 0 "+plotArea[2]+" "+plotArea[3],width:j,height:f,x:plotArea[0],y:plotArea[1]}),k=!1,E=!1,E=p.length<1?(k="log"==g,"log"==c):(k=p[0],p[1]),n=(M-T)/10,a=Math.floor(Math.log10(n)),le=Math.ceil(n/Math.pow(10,a)),y=v.findIndex(function(e){return le<=e}),n=v[y]*Math.pow(10,a),b=(logXEnbl?1<=M-T?1<(n=n<1?1:n)&&(x=x<n?x:n):x=0:x=5,(B-C)/10),a=Math.floor(Math.log10(b)),le=Math.ceil(b/Math.pow(10,a)),y=v.findIndex(function(e){return le<=e}),b=v[y]*Math.pow(10,a),S=(logYEnbl?1<=B-C?1<(b=b<1?1:b)&&(m=m<b?m:b):m=0:m=5,d.length<1&&4<=(M-T)/n&&(T=Math.floor(T/n)*n,M=Math.ceil(M/n)*n),s.length<1&&4<=(B-C)/b&&(C=Math.floor(C/b)*b,B=Math.ceil(B/b)*b),Math.ceil(T/n)*n),o=Math.floor(M/n)*n,r=Math.ceil(C/b)*b,h=Math.floor(B/b)*b,j=plotArea[2]*(S-T)/(M-T),f=plotArea[3]*(h-B)/(B-C),ie=100*(S-T)/(M-T),ne=100*(h-B)/(B-C),ae=Math.round((o-S)/n),oe=Math.round((h-r)/b),g=plotArea[2]>plotArea[3]?plotArea[2]/100:plotArea[3]/100,c=g/2;for(xTickLabel=logXEnbl?num2eng(decades(S,n,o)):num2eng(linspace(S,n,o)),yTickLabel=logYEnbl?num2eng(decades(r,b,h)):num2eng(linspace(r,b,h)),dXTick=plotArea[2]*n/(M-T),dXTickPct=100*n/(M-T),dYTick=plotArea[3]*b/(B-C),dYTickPct=100*b/(B-C),idx=0;idx<=oe;++idx){var re=-ne+dYTickPct*idx;(J=appendSvgText(te,yTickLabel[oe-idx],plotArea[0]-6,re+"%",12,"end")).setAttribute("alignment-baseline","middle")}for(idx=0;idx<=ae;++idx){var de=dXTickPct*idx+ie;appendSvgText(ee,xTickLabel[idx],de+"%",12*1.4,12)}var p=document.createElementNS(X,"defs"),se=(G.appendChild(p),E&&0<m&&(v=createSVGElement("g",{id:"mgy_"+t}),Y&&appendSvgLine(v,0,1,plotArea[2],1,stroke="rgb(223,223,223)",strokedasharray="2 4"),appendSvgLine(v,0,1,c,1),appendSvgLine(v,plotArea[2]-c,1,plotArea[2],1),p.appendChild(v)),createSVGElement("pattern",{id:"yTick_"+t,x:0,y:f-1,width:plotArea[2],height:dYTick,patternUnits:"userSpaceOnUse"}));if(p.appendChild(se),E&&0<m)for(logYEnbl&&1==b?(minorTickPos=logspace(1,9/(m-1),10)).forEach((e,t)=>{minorTickPos[t]=(1-minorTickPos[t])*dYTick}):minorTickPos=linspace(0,1/m*dYTick,dYTick),idx=1;idx<minorTickPos.length-1;++idx){var ge=createSVGElement("use",{href:"#mgy_"+t,y:minorTickPos[idx]});se.append(ge)}Y&&appendSvgLine(se,0,1,plotArea[2],1,stroke="rgb(223,223,223)"),appendSvgLine(se,0,1,g,1),appendSvgLine(se,plotArea[2]-g,1,plotArea[2],1);var y=createSVGElement("rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"url(#yTick_"+t+")"}),a=(G.appendChild(y),document.createElementNS(X,"defs")),ce=(G.appendChild(a),k&&0<x&&(d=createSVGElement("g",{id:"mgx_"+t}),Y&&appendSvgLine(d,1,0,1,plotArea[3],stroke="rgb(223,223,223)",strokedasharray="2 4"),appendSvgLine(d,1,0,1,c),appendSvgLine(d,1,plotArea[3]-c,1,plotArea[3]),a.appendChild(d)),createSVGElement("pattern",{id:"xTick_"+t,x:j-1,y:0,width:dXTick,height:plotArea[3],patternUnits:"userSpaceOnUse"}));if(a.appendChild(ce),k&&0<x)for(logXEnbl&&1==n?(minorTickPos=logspace(1,9/(x-1),10)).forEach((e,t)=>{minorTickPos[t]*=dXTick}):minorTickPos=linspace(0,1/x*dXTick,dXTick),idx=1;idx<minorTickPos.length-1;++idx){var pe=createSVGElement("use",{href:"#mgx_"+t,x:minorTickPos[idx],"vector-effect":"non-scaling-stroke"});ce.append(pe)}Y&&appendSvgLine(ce,1,0,1,plotArea[3],stroke="rgb(223,223,223)"),appendSvgLine(ce,1,0,1,g),appendSvgLine(ce,1,plotArea[3]-g,1,plotArea[3]);var s=createSVGElement("rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"url(#xTick_"+t+")"}),he=(G.appendChild(s),l.length/i),xe=e.length==l.length;if(!xe&&he!=e.length)throw new Error("Dimension must agree");for(lineIdx=0;lineIdx<i;++lineIdx){var N=e.length,me=new Array(2*N);for(colorIdx=lineIdx%D.length,ptIdx=0;ptIdx<he;++ptIdx){var ve=xe?e[lineIdx*he+ptIdx]:e[ptIdx],ue=l[lineIdx*he+ptIdx];me[2*ptIdx]=plotArea[2]*(ve-T)/(M-T),me[2*ptIdx+1]=plotArea[3]-plotArea[3]*(ue-C)/(B-C)}N=document.createElementNS(X,"polyline");N.setAttribute("class","l"),N.setAttribute("id","pl_"+t+"_"+lineIdx),N.setAttribute("points",me.join(" ")),N.setAttribute("stroke",D[colorIdx]),G.appendChild(N)}S=createSVGElement("rect",{x:0,y:0,width:plotArea[2],height:plotArea[3],fill:"none",stroke:"black","stroke-width":2,"vector-effect":"non-scaling-stroke"});G.appendChild(S),u.appendChild(G),u.appendChild(F),G.onclick=e=>plotClicked(e,t,plotArea[2],plotArea[3],T,M,C,B,logXEnbl,logYEnbl),0<P.length&&(F.onwheel=e=>scrollLegend(e,t,Z)),new ResizeObserver(()=>resizeSvg(t,L[0],L[1],Z,U)).observe(u)}